<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Jekyll Bootstrap</title>
 <link href="http://username.github.com/atom.xml" rel="self"/>
 <link href="http://username.github.com"/>
 <updated>2012-03-18T16:25:45+01:00</updated>
 <id>http://username.github.com</id>
 <author>
   <name>Name Lastname</name>
   <email>blah@email.test</email>
 </author>

 
 <entry>
   <title>cakePHP youtube datasource</title>
   <link href="http://username.github.com/2012/03/12/cakephp-youtube-datasource"/>
   <updated>2012-03-12T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2012/03/12/cakephp-youtube-datasource</id>
   <content type="html">I've seen in google analytics that mosts visitors of this blog speak english. I've thought that the italians can understand what i'm writing, so, here we are, i've switched language.
I've just pushed on github a &lt;a href=&quot;https://github.com/edap/cakePHP-youtube-datasource&quot;&gt;cakePHP youtube datasource&lt;/a&gt;, to retrieve information (all the metatags) regarding a video. It's still incomplete, I would like to add some others functionality, like retrieve the standard feed for a given category, or retrieve a video with more than X views. Ecc, anyway, Fork Me.
Here I provide a solution that I've adopted to save in the database the fields &quot;video_title&quot;, &quot;video_thumb&quot; and &quot;video_id&quot; for a given youtube video link associated to a model, for example an Article model containing a video, or a Submission Model containing a youtube video for a video contest. This code validates the video URL and, if valid, add the videos metatags to the data model to save, in this example, the Article model.
1)Follow the instruction on the github page and install the datasource
2) Add this rule to your $validate array in the model where you would like to save the video information
[php]
'video' =&gt; array(
    'rule' =&gt; 'validYoutube',
    'message' =&gt; 'the given videos link is incorrect',
    'allowEmpty' =&gt; true,
),
[/php]
3)Add this functions in the Model, that checks if the video is valid, and add the metatags to the $data array
[php]
&lt;? 
    public function validYoutube(array $data ){
        $url = current($data);
        $video_info = $this-&gt;getVideo($url);
        if ($video_info) {
            $this-&gt;setVideoValues($video_info);
            return true;
        }else{
            return false;
        }
    }

    public function getVideo($id){
	$this-&gt;Youtube = ConnectionManager::getDataSource('Youtube');	
        $video = $this-&gt;Youtube-&gt;findById($id);
        if (!$video) {
            return false;
        }
        $info = $this-&gt;Youtube-&gt;formatData($video);
        return $info;
    }

    public function setVideoValues($info){
        if (empty($info)) {
            return false;
        }
        $this-&gt;data['Article']['video'] = $info['id'];
        $this-&gt;data['Article']['video_thumb'] = $info['default_thumb'];
	$this-&gt;data['Article']['video_title'] = $info['title'];
    }
?&gt;
[/php] 
Thanks &lt;a href=&quot;http://debuggable.com/posts/datasources,-models,-components,-behaviors:48bd3025-2c44-40b6-a6e7-35674834cda3&quot;&gt;debuggable for this article&lt;/a&gt; on datasources in CakePHP
</content>
 </entry>
 
 <entry>
   <title>CakePHP 2.0 Comments Spam Datasource</title>
   <link href="http://username.github.com/2012/03/03/cakephp-2-0-comments-spam-datasource"/>
   <updated>2012-03-03T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2012/03/03/cakephp-2-0-comments-spam-datasource</id>
   <content type="html">Ho trovato questo &lt;a href=&quot;http://www.thelittlebakery.org/2011/06/admin-panel-development-akismet-product-review/&quot;&gt;post&lt;/a&gt; che spiega come implementare akismet per verificare i commenti sul nostro sito.Mi e' sembrata davvero la soluzione piu' semplice fra le tante disponibili. I commenti vengono salvati nel nostro database, e dopo il salvataggio verifichiamo tramite akismet se il commento e' spam o meno. Ecco qui i passaggi:
1) Scaricarsi il datasource &lt;a href=&quot;https://github.com/alexdd55/thelittlebakery/blob/master/app/Model/Datasource/akismet.php&quot;&gt;akismet.php&lt;/a&gt; ed metterlo in app/Model/Datasource.
1)Creare una api key sul sito di akisemt, ed aggiungere queste linee al file database.php
[php]
public $Akismet = array(
    'datasource' =&gt; 'Akismet',
    'blog' =&gt; 'http://yourblog/',
    'key' =&gt; 'your_akismet_key'
);
[/php] 
2)Nella nostra tabella destinanata ai commenti, aggiungere i campi spam e checked
3)Aggiungere al model Comment.php la seguente funzione.
[php]
public function checkForSpam($id) {
	$comment = $this-&gt;read(null, $id);
	App::uses('HttpSocket', 'Network/Http');
	$this-&gt;Http = new HttpSocket();
	$this-&gt;Akismet = ConnectionManager::getDataSource('Akismet');	
	$data = array(
	      'user_ip' =&gt; $comment['Comment']['ip'],
	      'user_agent' =&gt; $_SERVER['HTTP_USER_AGENT'],
	      'referrer' =&gt; 'http://www.google.com',
	      'permalink' =&gt; '/comments/view/'.$comment['Comment']['id'],
	      'comment_type' =&gt; 'comment',
	      'comment_author' =&gt; $comment['Comment']['name'],
	      'comment_author_email' =&gt; $comment['Comment']['email'],
	      'comment_author_url' =&gt; '',
	      'comment_content' =&gt; $comment['Comment']['text']
		);
	$check = $this-&gt;Akismet-&gt;checkSpam($data);
	if($check == 'true') {
		$spam = array(
			'id' =&gt; $comment['Comment']['id'],
			'checked' =&gt; 1,
			'spam' =&gt; 1
		);
	} else {
		$spam = array(
			'id' =&gt; $comment['Comment']['id'],
			'checked' =&gt; 1,
			'spam' =&gt; 0
		);
	};
	return $this-&gt;save($spam, false);
}
[/php]
4) Nel vostro CommentsController file, dopo aver salvato il commento richiamate la funzione appena creata. Es
[php]
public function add() {
	if ($this-&gt;request-&gt;is('post')) {
		$this-&gt;Comment-&gt;create();
		if ($this-&gt;Comment-&gt;save($this-&gt;request-&gt;data)) {
			$this-&gt;Comment-&gt;checkForSpam($this-&gt;Comment-&gt;getInsertID());
			$this-&gt;Session-&gt;setFlash(__('The comment has been saved'));
			$this-&gt;redirect(array('action' =&gt; 'index'));
		} else {
			$this-&gt;Session-&gt;setFlash(__('The comment could not be saved. Please, try again.'));
		}
	}
	$articles = $this-&gt;Comment-&gt;Article-&gt;find('list');
	$this-&gt;set(compact('articles'));
}
[/php]
5)Nella vostra sezione amministrativa, elencate tutti i commenti, e verificate i falsi positivi, in caso ce ne siano
6)Sul vostro sito, mostrate solo i commmenti con il valore di &quot;spam&quot; = 0
</content>
 </entry>
 
 <entry>
   <title>Stesso progetto in rails, due versioni di ruby e due gemset diversi</title>
   <link href="http://username.github.com/2012/03/02/stesso-progetto-in-rails-due-versioni-di-ruby-e-due-gemset-diversi"/>
   <updated>2012-03-02T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2012/03/02/stesso-progetto-in-rails-due-versioni-di-ruby-e-due-gemset-diversi</id>
   <content type="html">Supponiamo di avere un progetto in rails che usa rails 3.0.0 e ruby 1.8.7, ma di voler sviluppare parallelamente a questo, lo stesso progetto ma con ruby 1.9.3 e rails 3.2.2, per prepararci in tempo qual'ora verra' il momento di passare in produzione. Per fare questo creeremo un &lt;a href=&quot;/blog/2011/09/20/git_branch/&quot;&gt;branch&lt;/a&gt; &quot;develop&quot; che useremo per portare avanti la nostra applicazione sull'ultima release disponibile.
Per prima cosa, installiamo rvm come spiegato nel &lt;a href=&quot;/blog/2012/02/26/installare-ruby-rvm-ovvero-come-avere-differenti-versioni-di-ruby-sulla-stessa-macchina/&quot;&gt;post precedente&lt;/a&gt; e ripassiamo come creare dei branch in git, e switchare tra l'uno e l'altro. Poi spostiamoci nella cartella del nostro progetto, nel branch master.
creiamo il file .rvmrc contenente &quot;ruby.1.8.7@progetto&quot;. usciamo dalla cartella e rientriamo, apparira' un messaggio. &quot;Gemset 'progetto' does not exist, rvm gemset create 'progetto' first.&quot;. Facciamo quanto dice:
[bash]
gemset create progetto
gemset use progetto
gem install bundler
[/bash]
I primi due comandi dicono a ruby che per questo progetto esiste il gemset 'progetto' per la versione 1.8.7 e che quella va usata. se da linea di comando digitiamo &quot;rvm gemset list&quot;, verranno elencati tutti i gemset per la versione di ruby selezionata, e con un asterisco verra' contrassegnata la versione corrente.
L'ultimo comando installa bundler, onde evitare questo errore che potremmo avere al primo avvio di rails nel caso ce ne fossimo dimenticati:
[bash]
/usr/local/lib/site_ruby/1.8/rubygems/dependency.rb:247:in `to_specs': Could not find rails (&gt;= 0) amongst [bundler-1.0.22] (Gem::LoadError)
[/bash]
Bene, passiamo al branch develop, creaiamo il branch &quot;develop&quot;, e modifichiamo il file .rvmrc mettendo come valore ruby1.9.3@progetto. Come prima, creiamo il gemset per questa versione di ruby in questo progetto e diciamo a ruby di usare questa.
[bash]
gemset create progetto
gemset use progetto
gem install bundler
[/bash]
Dopo aver aggiornato il nostro Gemfile, aggiornando le gemme ad una versione piu' recente, lanciamo bundle.

Ricapitolando, abbiamo due branch, ognuno con una differente versione di ruby ed un diverso gemset.
master ruby 1.8.7, gemset 'progetto' per la versione 1.8.7
develop ruby 1.9.3, gemset 'progetto' per la versione 1.9.3
Per muoversi da un branch all'altro usare 'branch checkout'.
</content>
 </entry>
 
 <entry>
   <title>Installare Ruby RVM, ovvero come avere differenti versioni di ruby sulla stessa macchina</title>
   <link href="http://username.github.com/2012/02/26/installare-ruby-rvm-ovvero-come-avere-differenti-versioni-di-ruby-sulla-stessa-macchina"/>
   <updated>2012-02-26T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2012/02/26/installare-ruby-rvm-ovvero-come-avere-differenti-versioni-di-ruby-sulla-stessa-macchina</id>
   <content type="html">Ruby Virtual Machine serve per utilizzare differenti versioni di ruby sulla stessa macchina. In Ruby, data l'alta frequenza con cui vengono rilasciate le nuove release, e' molto facile avere progetti in produzione che funzionano con una versione vecchia di ruby. un altro scenario in cui RVM puo' tornare utile e' quello in cui vogliamo sperimentare la nuova versione di ruby al posto di quella predefinita dal nostro sistema.
Se scegliamo di affidarci a RVM, cosa saggia, e' bene che d'ora in avanti ogni progetto in ruby abbia la sua versione di ruby e relativo gemset definito in .rvmrc (vedi tutorial alla fine), e di non affidarsi piu'alla versione di ruby in /usr/bin ma a quella installata nella nostra /home/user/.rvm. Dopo aver completato quanto scritto in questa guida, il comando &quot;which ruby&quot; restituira' il path dell'eseguibile all'interno della nostra .rvm folder. Se invece da root, eseguiamo il comando &quot;which ruby&quot; quesyto ritornera' il path &quot;/usr/bin/ruby&quot;, perche' questo e' il path dell'eseguibile di sistema, mentre con rvm installiamo diverse versioni di ruby in user space, all'interno della nostra home. Si puo' installare rvm anche da root, ma e' una cosa che sconsiglio. Meglio avere una sola versione di ruby sull'intero sistema, e diverse versioni di ruby in user space, adattabili ai nostri progetti.
&lt;h4&gt;Installare RVM&lt;/h4&gt;
[bash]
$ bash -s stable &lt; &lt;(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)
[bash]
aggiungi questa linea alla fine di .bashrc
[bash]
[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; source &quot;$HOME/.rvm/scripts/rvm&quot;
[/bash]
ricarica il file &quot;.bashrc&quot;
[bash]
$ source ~/.bashrc
[/bash]
leggi bene cosa ti dice l'output di questo comando, e in caso installa quanto richiesto
[bash]
rvm requirements
[/bash]
Qui leggiamo
[bash]
To install rbx and/or Ruby 1.9 head (MRI) (eg. 1.9.2-head),
then you must install and use rvm 1.8.7 first
[/bash]
Ed e' quello che faremo.Per installa MRI dobbiamo prima installare ruby 1.8.7.MRI, Matz' Ruby Interpreter e' l'implementazione ufficiale di ruby scritta in C.
[bash]
apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-0 libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion
[/bash]
poi
[bash]
rvm install ruby 1.8.7
[/bash]
con questo comando possiamo invece vedere tutte le versioni di ruby che possiamo installare
[bash]
rvm list known
[/bash]
Ora possiamo installare ruby 1.9.3
[bash]
rvm install ruby 1.9.3
[/bash]

&lt;h4&gt;Passare da una versiona all'altra di ruby, o sceglierne una di default&lt;/h4&gt;
dando il comando
[bash]
rwm list
[/bash]
Possiamo avere un elenco delle versione di ruby installate. Per passare dalla 1.8.7 alla 1.9.3, diamo il comando
[bash]
rwm use 1.9.3
[/bash]
Se invece vogliamo usarne una di default, basta settarla
[bash]
 rvm --default use 1.9.3
[/bash]

&lt;h4&gt;.rvmrc&lt;/h4&gt;
Come far si che ogni progetto abbia la sua versione di ruby e il suo gemset gia' configurato.creiamo la cartella &quot;uno&quot; che conterra' un progetto che usa ruby 1.8.7 e la cartella &quot;due&quot; che usa ruby 1.9.3.
Spostiamoci in &quot;uno&quot; e creiamo il file .rvmrc contenente il nome della versione di ruby che vogliamo usare ed il nome del progetto separati dal simbolo &lt;b&gt;@&lt;/b&gt;.Quindi
[bash]
rvm 1.8.7@uno
[/bash]
Facciamo la stessa cosa nella cartella &quot;due&quot;, modificando i valori per il file .rvmrc
[bash]
rvm 1.9.3@due
[/bash]
Ora ritorniamo nella cartella &quot;uno&quot;, apparira' un warning, che ci dira' che non abbiamo il gemset installato. Digitiamo &quot;y&quot; ed andiamo avanti. spostandoci nelle cartelle e digitando &quot;ruby -v&quot; si puo' vedere come ruby cambi la versione a seconda di dove si trovi.
Per creare il gemset dove necessario(nel mio caso 1.9.3, perche' 1.8.7 era gia' installato) basta copiare il messagio letto nel warning ed eseguirlo nella directory dove abbiamo letto tale warning
[bash]
rvm gemset create 'due'
[/bash]
&lt;h4&gt;Aggiornare RVM&lt;/h4&gt;
All'ultima stable
[bash]
rvm get stable
[/bash]
Alla piu' recente
[bash]
rvm get latest
[/bash]
Alla recentissima piena di bugs
[bash]
rvm get head
[/bash]
rvm ha davvero un infinita' di opzioni, dare un occhio alla pagina help (rvm -h) per rendersene conto. Il progetto e' attivamente sviluppato qua &lt;a href=&quot;https://github.com/wayneeseguin/rvm&quot;&gt;https://github.com/wayneeseguin/rvm&lt;/a&gt;


&lt;strong&gt;Link utili:&lt;/strong&gt;
&lt;a href=&quot;http://beginrescueend.com/set/gem/&quot;&gt;http://beginrescueend.com/set/gem/&lt;/a&gt;
&lt;a href=&quot;http://beginrescueend.com/rvm/best-practices/&quot;&gt;http://beginrescueend.com/rvm/best-practices/&lt;/a&gt;
&lt;a href=&quot;http://screencasts.org/episodes/how-to-use-rvm&quot;&gt;http://screencasts.org/episodes/how-to-use-rvm&lt;/a&gt;
&lt;a href=&quot; http://rails.vandenabeele.com/blog/2011/11/26/installing-ruby-and-rails-with-rvm-on-ubuntu-11-dot-10/&quot;&gt;http://rails.vandenabeele.com/blog/2011/11/26/installing-ruby-and-rails-with-rvm-on-ubuntu-11-dot-10/&lt;/a&gt;
&lt;a href=&quot;http://beginrescueend.com/&quot;&gt;http://beginrescueend.com/&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Jekyll Introduction</title>
   <link href="http://username.github.com/lessons/2011/12/29/jekyll-introduction"/>
   <updated>2011-12-29T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/lessons/2011/12/29/jekyll-introduction</id>
   <content type="html">&lt;p&gt;This Jekyll introduction will outline specifically what Jekyll is and why you would want to use it. Directly following the intro we&amp;#8217;ll learn exactly &lt;em&gt;how&lt;/em&gt; Jekyll does what it does.&lt;/p&gt;

&lt;h2 id='overview'&gt;Overview&lt;/h2&gt;

&lt;h3 id='what_is_jekyll'&gt;What is Jekyll?&lt;/h3&gt;

&lt;p&gt;Jekyll is a parsing engine bundled as a ruby gem used to build static websites from dynamic components such as templates, partials, liquid code, markdown, etc. Jekyll is known as &amp;#8220;a simple, blog aware, static site generator&amp;#8221;.&lt;/p&gt;

&lt;h3 id='examples'&gt;Examples&lt;/h3&gt;

&lt;p&gt;This website is created with Jekyll. &lt;a href='https://github.com/mojombo/jekyll/wiki/Sites'&gt;Other Jekyll websites&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id='what_does_jekyll_do'&gt;What does Jekyll Do?&lt;/h3&gt;

&lt;p&gt;Jekyll is a ruby gem you install on your local system. Once there you can call &lt;code&gt;jekyll --server&lt;/code&gt; on a directory and provided that directory is setup in a way jekyll expects, it will do magic stuff like parse markdown/textile files, compute categories, tags, permalinks, and construct your pages from layout templates and partials.&lt;/p&gt;

&lt;p&gt;Once parsed, Jekyll stores the result in a self-contained static &lt;code&gt;_site&lt;/code&gt; folder. The intention here is that you can serve all contents in this folder statically from a plain static web-server.&lt;/p&gt;

&lt;p&gt;You can think of Jekyll as a normalish dynamic blog but rather than parsing content, templates, and tags on each request, Jekyll does this once &lt;em&gt;beforehand&lt;/em&gt; and caches the &lt;em&gt;entire website&lt;/em&gt; in a folder for serving statically.&lt;/p&gt;

&lt;h3 id='jekyll_is_not_blogging_software'&gt;Jekyll is Not Blogging Software&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Jekyll is a parsing engine.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Jekyll does not come with any content nor does it have any templates or design elements. This is a common source of confusion when getting started. Jekyll does not come with anything you actually use or see on your website - you have to make it.&lt;/p&gt;

&lt;h3 id='why_should_i_care'&gt;Why Should I Care?&lt;/h3&gt;

&lt;p&gt;Jekyll is very minimalistic and very efficient. The most important thing to realize about Jekyll is that it creates a static representation of your website requiring only a static web-server. Traditional dynamic blogs like Wordpress require a database and server-side code. Heavily trafficked dynamic blogs must employ a caching layer that ultimately performs the same job Jekyll sets out to do; serve static content.&lt;/p&gt;

&lt;p&gt;Therefore if you like to keep things simple and you prefer the command-line over an admin panel UI then give Jekyll a try.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Developers like Jekyll because we can write content like we write code:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ability to write content in markdown or textile in your favorite text-editor.&lt;/li&gt;

&lt;li&gt;Ability to write and preview your content via localhost.&lt;/li&gt;

&lt;li&gt;No internet connection required.&lt;/li&gt;

&lt;li&gt;Ability to publish via git.&lt;/li&gt;

&lt;li&gt;Ability to host your blog on a static web-server.&lt;/li&gt;

&lt;li&gt;Ability to host freely on GitHub Pages.&lt;/li&gt;

&lt;li&gt;No database required.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id='how_jekyll_works'&gt;How Jekyll Works&lt;/h1&gt;

&lt;p&gt;The following is a complete but concise outline of exactly how Jekyll works.&lt;/p&gt;

&lt;p&gt;Be aware that core concepts are introduced in rapid succession without code examples. This information is not intended to specifically teach you how to do anything, rather it is intended to give you the &lt;em&gt;full picture&lt;/em&gt; relative to what is going on in Jekyll-world.&lt;/p&gt;

&lt;p&gt;Learning these core concepts should help you avoid common frustrations and ultimately help you better understand the code examples contained throughout Jekyll-Bootstrap.&lt;/p&gt;

&lt;h2 id='initial_setup'&gt;Initial Setup&lt;/h2&gt;

&lt;p&gt;After &lt;a href='/index.html#start-now'&gt;installing jekyll&lt;/a&gt; you&amp;#8217;ll need to format your website directory in a way jekyll expects. Jekyll-bootstrap conveniently provides the base directory format.&lt;/p&gt;

&lt;h3 id='the_jekyll_application_base_format'&gt;The Jekyll Application Base Format&lt;/h3&gt;

&lt;p&gt;Jekyll expects your website directory to be laid out like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.
|-- _config.yml
|-- _includes
|-- _layouts
|   |-- default.html
|   |-- post.html
|-- _posts
|   |-- 20011-10-25-open-source-is-good.markdown
|   |-- 20011-04-26-hello-world.markdown
|-- _site
|-- index.html
|-- assets
    |-- css
        |-- style.css
    |-- javascripts&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;_config.yml&lt;/strong&gt;&lt;br /&gt;Stores configuration data.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;_includes&lt;/strong&gt;&lt;br /&gt;This folder is for partial views.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;_layouts&lt;/strong&gt; &lt;br /&gt;This folder is for the main templates your content will be inserted into. You can have different layouts for different pages or page sections.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;_posts&lt;/strong&gt;&lt;br /&gt;This folder contains your dynamic content/posts. the naming format is required to be &lt;code&gt;@YEAR-MONTH-DATE-title.MARKUP@&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;_site&lt;/strong&gt;&lt;br /&gt;This is where the generated site will be placed once Jekyll is done transforming it.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;assets&lt;/strong&gt;&lt;br /&gt;This folder is not part of the standard jekyll structure. The assets folder represents &lt;em&gt;any generic&lt;/em&gt; folder you happen to create in your root directory. Directories and files not properly formatted for jekyll will be left untouched for you to serve normally.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(read more: &lt;a href='https://github.com/mojombo/jekyll/wiki/Usage'&gt;https://github.com/mojombo/jekyll/wiki/Usage&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id='jekyll_configuration'&gt;Jekyll Configuration&lt;/h3&gt;

&lt;p&gt;Jekyll supports various configuration options that are fully outlined here: &lt;a href='https://github.com/mojombo/jekyll/wiki/Configuration'&gt;https://github.com/mojombo/jekyll/wiki/Configuration&lt;/a&gt;&lt;/p&gt;

&lt;h2 id='content_in_jekyll'&gt;Content in Jekyll&lt;/h2&gt;

&lt;p&gt;Content in Jekyll is either a post or a page. These content &amp;#8220;objects&amp;#8221; get inserted into one or more templates to build the final output for its respective static-page.&lt;/p&gt;

&lt;h3 id='posts_and_pages'&gt;Posts and Pages&lt;/h3&gt;

&lt;p&gt;Both posts and pages should be written in markdown, textile, or HTML and may also contain Liquid templating syntax. Both posts and pages can have meta-data assigned on a per-page basis such as title, url path, as well as arbitrary custom meta-data.&lt;/p&gt;

&lt;h3 id='working_with_posts'&gt;Working With Posts&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Creating a Post&lt;/strong&gt; &lt;br /&gt;Posts are created by properly formatting a file and placing it the &lt;code&gt;_posts&lt;/code&gt; folder.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Formatting&lt;/strong&gt;&lt;br /&gt;A post must have a valid filename in the form &lt;code&gt;YEAR-MONTH-DATE-title.MARKUP&lt;/code&gt; and be placed in the &lt;code&gt;_posts&lt;/code&gt; directory. If the data format is invalid Jekyll will not recognize the file as a post. The date and title are automatically parsed from the filename of the post file. Additionally, each file must have &lt;a href='https://github.com/mojombo/jekyll/wiki/YAML-Front-Matter'&gt;YAML Front-Matter&lt;/a&gt; prepended to its content. YAML Front-Matter is a valid YAML syntax specifying meta-data for the given file.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Order&lt;/strong&gt;&lt;br /&gt;Ordering is an important part of Jekyll but it is hard to specify a custom ordering strategy. Only reverse chronological and chronological ordering is supported in Jekyll.&lt;/p&gt;

&lt;p&gt;Since the date is hard-coded into the filename format, to change the order, you must change the dates in the filenames.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Tags&lt;/strong&gt; &lt;br /&gt;Posts can have tags associated with them as part of their meta-data. Tags may be placed on posts by providing them in the post&amp;#8217;s YAML front matter. You have access to the post-specific tags in the templates. These tags also get added to the sitewide collection.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Categories&lt;/strong&gt; &lt;br /&gt;Posts may be categorized by providing one or more categories in the YAML front matter. Categories offer more significance over tags in that they can be reflected in the URL path to the given post. Note categories in Jekyll work in a specific way. If you define more than one category you are defining a category hierarchy &amp;#8220;set&amp;#8221;. Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;---
title :  Hello World
categories : [lessons, beginner]
---&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This defines the category hierarchy &amp;#8220;lessons/beginner&amp;#8221;. Note this is &lt;em&gt;one category&lt;/em&gt; node in Jekyll. You won&amp;#8217;t find &amp;#8220;lessons&amp;#8221; and &amp;#8220;beginner&amp;#8221; as two separate categories unless you define them elsewhere as singular categories.&lt;/p&gt;

&lt;h3 id='working_with_pages'&gt;Working With Pages&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Creating a Page&lt;/strong&gt;&lt;br /&gt;Pages are created by properly formatting a file and placing it anywhere in the root directory or subdirectories that do &lt;em&gt;not&lt;/em&gt; start with an underscore.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Formatting&lt;/strong&gt;&lt;br /&gt;In order to register as a Jekyll page the file must contain &lt;a href='https://github.com/mojombo/jekyll/wiki/YAML-Front-Matter'&gt;YAML Front-Matter&lt;/a&gt;. Registering a page means 1) that Jekyll will process the page and 2) that the page object will be available in the &lt;code&gt;site.pages&lt;/code&gt; array for inclusion into your templates.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Categories and Tags&lt;/strong&gt;&lt;br /&gt;Pages do not compute categories nor tags so defining them will have no effect.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sub-Directories&lt;/strong&gt;&lt;br /&gt;If pages are defined in sub-directories, the path to the page will be reflected in the url. Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.
|-- people
    |-- bob
        |-- essay.html&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This page will be available at &lt;code&gt;http://yourdomain.com/people/bob/essay.html&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Recommended Pages&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;index.html&lt;/strong&gt;&lt;br /&gt;You will always want to define the root index.html page as this will display on your root URL.&lt;/li&gt;

&lt;li&gt;&lt;strong&gt;404.html&lt;/strong&gt;&lt;br /&gt;Create a root 404.html page and GitHub Pages will serve it as your 404 response.&lt;/li&gt;

&lt;li&gt;&lt;strong&gt;sitemap.html&lt;/strong&gt;&lt;br /&gt;Generating a sitemap is good practice for SEO.&lt;/li&gt;

&lt;li&gt;&lt;strong&gt;about.html&lt;/strong&gt;&lt;br /&gt;A nice about page is easy to do and gives the human perspective to your website.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id='templates_in_jekyll'&gt;Templates in Jekyll&lt;/h2&gt;

&lt;p&gt;Templates are used to contain a page&amp;#8217;s or post&amp;#8217;s content. All templates have access to a global site object variable: &lt;code&gt;site&lt;/code&gt; as well as a page object variable: &lt;code&gt;page&lt;/code&gt;. The site variable holds all accessible content and metadata relative to the site. The page variable holds accessible data for the given page or post being rendered at that point.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create a Template&lt;/strong&gt;&lt;br /&gt;Templates are created by properly formatting a file and placing it in the &lt;code&gt;_layouts&lt;/code&gt; directory.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Formatting&lt;/strong&gt;&lt;br /&gt;Templates should be coded in HTML and contain YAML Front Matter. All templates can contain Liquid code to work with your site&amp;#8217;s data.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Rending Page/Post Content in a Template&lt;/strong&gt;&lt;br /&gt;There is a special variable in all templates named : &lt;code&gt;content&lt;/code&gt;. The &lt;code&gt;content&lt;/code&gt; variable holds the page/post content including any sub-template content previously defined. Render the content variable wherever you want your main content to be injected into your template:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;...
&amp;lt;body&amp;gt;
  &amp;lt;div id=&quot;sidebar&quot;&amp;gt; ... &amp;lt;/div&amp;gt;
  &amp;lt;div id=&quot;main&quot;&amp;gt;
    &amp;#123;{content}&amp;#125;
  &amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
...&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id='subtemplates'&gt;Sub-Templates&lt;/h3&gt;

&lt;p&gt;Sub-templates are exactly templates with the only difference being they define another &amp;#8220;root&amp;#8221; layout/template within their YAML Front Matter. This essentially means a template will render inside of another template.&lt;/p&gt;

&lt;h3 id='includes'&gt;Includes&lt;/h3&gt;

&lt;p&gt;In Jekyll you can define include files by placing them in the &lt;code&gt;_includes&lt;/code&gt; folder. Includes are NOT templates, rather they are just code snippets that get included into templates. In this way, you can treat the code inside includes as if it was native to the parent template.&lt;/p&gt;

&lt;p&gt;Any valid template code may be used in includes.&lt;/p&gt;

&lt;h2 id='using_liquid_for_templating'&gt;Using Liquid for Templating&lt;/h2&gt;

&lt;p&gt;Templating is perhaps the most confusing and frustrating part of Jekyll. This is mainly due to the fact that Jekyll templates must use the Liquid Templating Language.&lt;/p&gt;

&lt;h3 id='what_is_liquid'&gt;What is Liquid?&lt;/h3&gt;

&lt;p&gt;&lt;a href='https://github.com/Shopify/liquid'&gt;Liquid&lt;/a&gt; is a secure templating language developed by &lt;a href='http://shopify.com'&gt;Shopify&lt;/a&gt;. Liquid is designed for end-users to be able to execute logic within template files without imposing any security risk on the hosting server.&lt;/p&gt;

&lt;p&gt;Jekyll uses Liquid to generate the post content within the final page layout structure and as the primary interface for working with your site and post/page data.&lt;/p&gt;

&lt;h3 id='why_do_we_have_to_use_liquid'&gt;Why Do We Have to Use Liquid?&lt;/h3&gt;

&lt;p&gt;GitHub uses Jekyll to power &lt;a href='http://pages.github.com/'&gt;GitHub Pages&lt;/a&gt;. GitHub cannot afford to run arbitrary code on their servers so they lock developers down via Liquid.&lt;/p&gt;

&lt;h3 id='liquid_is_not_programmerfriendly'&gt;Liquid is Not Programmer-Friendly.&lt;/h3&gt;

&lt;p&gt;The short story is liquid is not real code and its not intended to execute real code. The point being you can&amp;#8217;t do jackshit in liquid that hasn&amp;#8217;t been allowed explicitly by the implementation. What&amp;#8217;s more you can only access data-structures that have been explicitly passed to the template.&lt;/p&gt;

&lt;p&gt;In Jekyll&amp;#8217;s case it is not possible to alter what is passed to Liquid without hacking the gem or running custom plugins. Both of which cannot be supported by GitHub Pages.&lt;/p&gt;

&lt;p&gt;As a programmer - this is very frustrating.&lt;/p&gt;

&lt;p&gt;But rather than look a gift horse in the mouth we are going to suck it up and view it as an opportunity to work around limitations and adopt client-side solutions when possible.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aside&lt;/strong&gt; &lt;br /&gt;My personal stance is to not invest time trying to hack liquid. It&amp;#8217;s really unnecessary &lt;em&gt;from a programmer&amp;#8217;s&lt;/em&gt; perspective. That is to say if you have the ability to run custom plugins (i.e. run arbitrary ruby code) you are better off sticking with ruby. Toward that end I&amp;#8217;ve built &lt;a href='http://github.com/plusjade/mustache-with-jekyll'&gt;Mustache-with-Jekyll&lt;/a&gt;&lt;/p&gt;

&lt;h2 id='static_assets'&gt;Static Assets&lt;/h2&gt;

&lt;p&gt;Static assets are any file in the root or non-underscored subfolders that are not pages. That is they have no valid YAML Front Matter and are thus not treated as Jekyll Pages.&lt;/p&gt;

&lt;p&gt;Static assets should be used for images, css, and javascript files.&lt;/p&gt;

&lt;h2 id='how_jekyll_parses_files'&gt;How Jekyll Parses Files&lt;/h2&gt;

&lt;p&gt;Remember Jekyll is a processing engine. There are two main types of parsing in Jekyll.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Content parsing.&lt;/strong&gt; &lt;br /&gt;This is done with textile or markdown.&lt;/li&gt;

&lt;li&gt;&lt;strong&gt;Template parsing.&lt;/strong&gt; &lt;br /&gt;This is done with the liquid templating language.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And thus there are two main types of file formats needed for this parsing.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Post and Page files.&lt;/strong&gt;&lt;br /&gt;All content in Jekyll is either a post or a page so valid posts and pages are parsed with markdown or textile.&lt;/li&gt;

&lt;li&gt;&lt;strong&gt;Template files.&lt;/strong&gt; &lt;br /&gt;These files go in &lt;code&gt;_layouts&lt;/code&gt; folder and contain your blogs &lt;strong&gt;templates&lt;/strong&gt;. They should be made in HTML with the help of Liquid syntax. Since include files are simply injected into templates they are essentially parsed as if they were native to the template.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Arbitrary files and folders.&lt;/strong&gt; &lt;br /&gt;Files that &lt;em&gt;are not&lt;/em&gt; valid pages are treated as static content and pass through Jekyll untouched and reside on your blog in the exact structure and format they originally existed in.&lt;/p&gt;

&lt;h3 id='formatting_files_for_parsing'&gt;Formatting Files for Parsing.&lt;/h3&gt;

&lt;p&gt;We&amp;#8217;ve outlined the need for valid formatting using &lt;strong&gt;YAML Front Matter&lt;/strong&gt;. Templates, posts, and pages all need to provide valid YAML Front Matter even if the Matter is empty. This is the only way Jekyll knows you want the file processed.&lt;/p&gt;

&lt;p&gt;YAML Front Matter must be prepended to the top of template/post/page files:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;---
layout: post
category : pages
tags : [how-to, jekyll]
---

... contents ...&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Three hyphens on a new line start the Front-Matter block and three hyphens on a new line end the block. The data inside the block must be valid YAML.&lt;/p&gt;

&lt;p&gt;Configuration parameters for YAML Front-Matter is outlined here: &lt;a href='https://github.com/mojombo/jekyll/wiki/YAML-Front-Matter'&gt;A comprehensive explanation of YAML Front Matter&lt;/a&gt;&lt;/p&gt;

&lt;h4 id='defining_layouts_for_posts_and_templates_parsing'&gt;Defining Layouts for Posts and Templates Parsing.&lt;/h4&gt;

&lt;p&gt;The &lt;code&gt;layout&lt;/code&gt; parameter in the YAML Front Matter defines the template file for which the given post or template should be injected into. If a template file specifies its own layout, it is effectively being used as a &lt;code&gt;sub-template.&lt;/code&gt; That is to say loading a post file into a template file that refers to another template file with work in the way you&amp;#8217;d expect; as a nested sub-template.&lt;/p&gt;

&lt;h2 id='how_jekyll_generates_the_final_static_files'&gt;How Jekyll Generates the Final Static Files.&lt;/h2&gt;

&lt;p&gt;Ultimately, Jekyll&amp;#8217;s job is to generate a static representation of your website. The following is an outline of how that&amp;#8217;s done:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jekyll collects data.&lt;/strong&gt; &lt;br /&gt;Jekyll scans the posts directory and collects all posts files as post objects. It then scans the layout assets and collects those and finally scans other directories in search of pages.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jekyll computes data.&lt;/strong&gt; &lt;br /&gt;Jekyll takes these objects, computes metadata (permalinks, tags, categories, titles, dates) from them and constructs one big &lt;code&gt;site&lt;/code&gt; object that holds all the posts, pages, layouts, and respective metadata. At this stage your site is one big computed ruby object.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jekyll liquifies posts and templates.&lt;/strong&gt;&lt;br /&gt;Next jekyll loops through each post file and converts (through markdown or textile) and &lt;strong&gt;liquifies&lt;/strong&gt; the post inside of its respective layout(s). Once the post is parsed and liquified inside the the proper layout structure, the layout itself is &amp;#8220;liquified&amp;#8221;. &lt;br /&gt;&lt;strong&gt;Liquification&lt;/strong&gt; is defined as follows: Jekyll initiates a Liquid template, and passes a simpler hash representation of the ruby site object as well as a simpler hash representation of the ruby post object. These simplified data structures are what you have access to in the templates.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jekyll generates output.&lt;/strong&gt; &lt;br /&gt;Finally the liquid templates are &amp;#8220;rendered&amp;#8221;, thereby processing any liquid syntax provided in the templates and saving the final, static representation of the file.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;Notes.&lt;/strong&gt;&lt;br /&gt;Because Jekyll computes the entire site in one fell swoop, each template is given access to a global &lt;code&gt;site&lt;/code&gt; hash that contains useful data. It is this data that you&amp;#8217;ll iterate through and format using the Liquid tags and filters in order to render it onto a given page.&lt;/p&gt;

&lt;p&gt;Remember, in Jekyll you are an end-user. Your API has only two components:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;The manner in which you setup your directory.&lt;/li&gt;

&lt;li&gt;The liquid syntax and variables passed into the liquid templates.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;All the data objects available to you in the templates via Liquid are outlined in the &lt;strong&gt;API Section&lt;/strong&gt; of Jekyll-Bootstrap. You can also read the original documentation here: &lt;a href='https://github.com/mojombo/jekyll/wiki/Template-Data'&gt;https://github.com/mojombo/jekyll/wiki/Template-Data&lt;/a&gt;&lt;/p&gt;

&lt;h2 id='conclusion'&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I hope this paints a clearer picture of what Jekyll is doing and why it works the way it does. As noted, our main programming constraint is the fact that our API is limited to what is accessible via Liquid and Liquid only.&lt;/p&gt;

&lt;p&gt;Jekyll-bootstrap is intended to provide helper methods and strategies aimed at making it more intuitive and easier to work with Jekyll =)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Thank you&lt;/strong&gt; for reading this far.&lt;/p&gt;

&lt;h2 id='next_steps'&gt;Next Steps&lt;/h2&gt;

&lt;p&gt;Please take a look at &lt;a href='' /&gt; or jump right into &lt;a href=''&gt;Usage&lt;/a&gt; if you&amp;#8217;d like.&lt;/p&gt;</content>
 </entry>
 
 <entry>
   <title>Contare child rows per un determinato record.</title>
   <link href="http://username.github.com/2011/12/09/contare-child-rows-per-un-determinato-record"/>
   <updated>2011-12-09T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2011/12/09/contare-child-rows-per-un-determinato-record</id>
   <content type="html">Supponiamo il caso di avere un post con relativi articoli, un autore con molti libri, una ditta che ha ricevuto degli ordini, o ancora, un la risposta piu' votata all'interno di un questionario.
In tutti questi casi, per ogni record principale avremo piu' record correlati. Supponiamo il caso di voler contare, nella pagina dove vengono elencate le risposte, quanti voti ogni risposta ha ricevuto, mostrando la piu' votata per prima. In Rails, possiamo scrivere un apposito metodo direttamente nel model.
[ruby]
class Answer &lt; ActiveRecord::Base
	belongs_to :survey
	has_many :vote, :dependent =&gt; :destroy	
	
	def self.more_voted(survey_id)
		voted_answer = find(
			:all, :select =&gt; 'answers.*, count(votes.id) as vote_count',
			:conditions =&gt; [&quot;answers.survey_id = ?&quot;, survey_id],			
			:joins =&gt; 'left outer join votes on votes.answer_id = answers.id',
			:group =&gt; 'answers.id',
			:Order =&gt; 'vote_count DESC'
		)		
	end
end
[/ruby]

Ora nella nostra action 'show' per il controller survey, dove vengono elencate tutte le risposte per il tal survey, possiamo recuperare le answer con il metodo appena creato.
[ruby]
@answers = Answer.more_voted(params[:survey_id])
[/ruby]
e mostrare nella view il valore 'vote_count'
[ruby]
&lt;% @answers.each do |a| %&gt;
	&lt;tr class=&quot;even&quot;&gt;
	&lt;td&gt;&lt;%= &quot;#{a.reply}&quot; %&gt;&lt;/td&gt;
	&lt;td&gt;&lt;%= &quot;#{a.vote_count}&quot; %&gt; &lt;/td&gt;
	&lt;/tr&gt;
&lt;% end %&gt;
[/ruby]
Link consigliati:
&lt;a href=&quot;http://therailsway.com/2007/6/1/railsconf-recap-skinny-controllers&quot;&gt;http://therailsway.com/2007/6/1/railsconf-recap-skinny-controllers&lt;/a&gt;
&lt;a href=&quot;http://blog.devinterface.com/2010/06/rails-best-practices-1-fat-model-skinny-controller/&quot;&gt;http://blog.devinterface.com/2010/06/rails-best-practices-1-fat-model-skinny-controller/&lt;/a&gt;
&lt;a href=&quot;http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model&quot;&gt;http://weblog.jamisbuck.org/2006/10/18/skinny-controller-fat-model&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Aggiungere una action ad un controller in rails3</title>
   <link href="http://username.github.com/2011/12/02/aggiungere-una-action-ad-un-controller-in-rails3"/>
   <updated>2011-12-02T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2011/12/02/aggiungere-una-action-ad-un-controller-in-rails3</id>
   <content type="html">Rails3 cread i default &lt;a href=&quot;http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions&quot;&gt;sette azioni&lt;/a&gt; per ogni controller generato dinamicamente.
Se vogliamo aggiungere un azione, che ne so, per aggiornare un solo valore nel database, per una nuova view, o per quasiasi altra cosa, dobbiamo:
1)Scrivere la nostra azione nel controller, in questo esempio scrivero' un azione per disapprovare un commento, settando a &quot;0&quot; il valore del campo &quot;approved&quot;.
[ruby]
def disapprove
	@comment = Comment.find(params[:id])
	if ( @comment.update_attribute(:approved, &quot;0&quot;))
		respond_to do |format|
			format.html { redirect_to(admin_comment_url(@comment), 
					:notice =&gt; 'Comment was unapproved.') }
			format.xml  { head:ok }
		end
	else
		respond_to do |format|
			format.html { render :action =&gt; &quot;edit&quot; }
			format.xml  {render:xml=&gt;@comment.errors, :status =&gt; :unprocessable_entity }
		end	
	end		
end
[/ruby]
Nel mio file routes.rb, dovro' dire alla mia app che oltre alle 7 azioni canoniche ce ne' un altra, disapprove. E dovro' specifivare che tipo di http request e', tra post, get, put e delete. Nel mio caso ho messo post, piu' dettagli &lt;a href=&quot;http://guides.rubyonrails.org/routing.html#adding-more-restful-actions&quot;&gt;qui&lt;/a&gt;
[ruby]
resources :comment do
	post 'disapprove',:on=&gt;:member
end
[/ruby]
Lanciando &quot;rake routes&quot; nella cartella della mia app, posso vedere la nuova route creata, e vedere quale e' l'url da utlizzare nell'helper. Nel mio caso l'approvazione dei commenti si trova nell'admin area.
[ruby]
disapprove_admin_comment POST   /admin/comments/:id/disapprove(.:format)              {:controller=&gt;&quot;admin/comments&quot;, :action=&gt;&quot;disapprove&quot;}
[/ruby]
Ora creaimo un link all'azione
[ruby]
&lt;%= link_to 'Disapprove', disapprove_admin_comment_path(@comment)%&gt;
[/ruby]
Dopo aver generato questo link, ottenevo un errore &quot;No route matches...&quot; la mia azione.
Errore risolto&lt;a href=&quot;http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to&quot;&gt; specificando&lt;/a&gt; nel link il tipo di http verb
[ruby]
&lt;%= link_to 'Disapprove', disapprove_admin_comment_path(@comment), :method=&gt;'post' %&gt;
[/ruby]
 
Consiglio questi screencast, per capire come vengono generate le routes, &lt;a href=&quot;http://railscasts.com/episodes/231-routing-walkthrough&quot;&gt;1&lt;/a&gt; e &lt;a href=&quot;http://railscasts.com/episodes/232-routing-walkthrough-part-2&quot;&gt;2&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Creare un admin area in rails3 usando l'autenticazione scritta in devise</title>
   <link href="http://username.github.com/2011/11/17/creare-un-admin-area-in-rails3-usando-lautenticazione-scritta-in-devise"/>
   <updated>2011-11-17T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2011/11/17/creare-un-admin-area-in-rails3-usando-lautenticazione-scritta-in-devise</id>
   <content type="html">&lt;strong&gt;1)&lt;/strong&gt;aggiungere il namespace &quot;admin&quot; in routes.rb, ed abbinarlo ai controller per i quali vogliamo l'autenticazione, in questo esempio &quot;questions&quot;.
[ruby]
namespace :admin do
	match '/' =&gt; 'questions#index'
	resources :questions
end
[/ruby]
&lt;strong&gt;2&lt;/strong&gt;In views/layout creare il layout admin.html.erb specificando le parti che vogliamo mostrare nella sezione admin.
&lt;strong&gt;3)&lt;/strong&gt; creare il controller admin_controller.rb in controllers/admin e utilizzare &quot;autenticate_user&quot; (vedere il tutorial su &lt;a href=&quot;/blog/2011/07/24/ruby-on-rails-devise-authentication/&quot;&gt;devise&lt;/a&gt;) per verificare che un utente sia loggato
[ruby]
class Admin::AdminController &amp;lt; ApplicationController
	layout &quot;admin&quot;
	before_filter :authenticate_user!
end
[/ruby]

&lt;strong&gt;4)&lt;/strong&gt; Sempre in controllers/admin, creare il file questions_controller.rb
[ruby]
class Admin::QuestionsController &lt; Admin::AdminController
  def index
    @questions = Question.all
    respond_to do |format|
      format.html # index.html.erb
    end
  end
end
[/ruby]
&lt;strong&gt;5)&lt;/strong&gt;in views/admin creaimo la cartella &quot;questions&quot; e inderiamo tutte le views richieste dal controller controllers/admin/questions_controller.rb, in questo caso, solo il file index.html.rb
&lt;strong&gt;6&lt;/strong&gt;
Le action dei form all'interno delle views in views/admin/questions devono rimandare ai controllers in controllers/admin/question controller. Quindi, sempre tenendo &quot;question&quot; come esempio da:
[ruby]
&lt;%= form_for(@answer) do |f| %&gt;
[/ruby]
dobbiamo passare a 
[ruby]
&lt;%= form_for(:admin, @answer) do |f| %&gt;
[/ruby]
</content>
 </entry>
 
 <entry>
   <title>creare un fork da un plugin su Github e svilupparlo come submodule</title>
   <link href="http://username.github.com/2011/10/15/creare-un-fork-da-un-plugin-su-github-e-svilupparlo-come-submodule"/>
   <updated>2011-10-15T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/10/15/creare-un-fork-da-un-plugin-su-github-e-svilupparlo-come-submodule</id>
   <content type="html">Sto sviluppando un'applicazione in CakePhp 2.0 e voglio usare dei plugin che sono ancora fermi alla versione 1.3 di CakePhp. Per ora, rinominare qualche cartella sembra essere sufficiente. Per tenere traccia del lavoro fatto e per far si che qualcun altro possa usufruirne, ho trovato molto utile &quot;git sumbodule&quot;. Vediamo come creare un &lt;a href=&quot;http://help.github.com/fork-a-repo/&quot;&gt;fork&lt;/a&gt; da un plugin e svilupparlo in locale come un submodule.
Per prima cosa installiamo la versione 2.0 di cake e inizializzamo un repository git.
Poi andiamo su github e scegliamo il plugin da adattare alla versione 2.0 di Cake, per esempio il plugin &lt;a href=&quot;https://github.com/CakeDC/categories&quot;&gt;categories di CakeDc&lt;/a&gt;. Creiamo un fork con il bottone... fork. Poi Andiamo in &quot;Admin&quot;, selezioniamo il repository appena forkato e diciamo a github quale deve essere il &quot;default branch&quot;, in questo caso, scegliamo il 2.0.
Importante! quando cloniamo o installiamo come submodule un repo da github, questo si porta con appresso tutti i branches. Sta a noi decidere con &quot;git checkout nomebranch&quot; su quale branch lavorare.
&lt;h5&gt;Aggiungere il submodule&lt;/h5&gt;
Dobbiamo dire a git di aggiungere un submodule contenente il codice del nostro fork, per esempio git@github.com:user/categories.git
[bash]
git submodule add git@github.com:user/categories.git app/Plugin/Categories
[/bash]
Se vogliamo aggiungere solo un particolare branch, per esempio il 2.0, dobbiamo aggiunger il flag -b al comando precedente
[bash]
git submodule add -b 2.0 git@github.com:user/categories.git app/Plugin/Categories
[/bash]
Poi spostiamoci nella cartella del plugin appena scaricato e diciamo a git dove e' il repository remote
[bash]
cd app/Plugin/Categories
git remote add push git@github.com:user/categories.git
[/bash]
Proviamo a modificare un file del plugin, e sempre dalla cartella del plugin, eseguiamo il commit ed il push.
[bash]
git add .
git commit -m &quot;test commit&quot;
git push master
[/bash]
&lt;h5&gt;Aggiungere l'indirizzo remote originario del repo forkato&lt;/h5&gt;
Automaticamente, la nostra &quot;origin&quot; e' il nostro repo forkato su github, non il repo originario(quello di CakeDC in questo esempio).
Per dire a git di scaricare gli aggiornamenti fatti dagli sviluppatori di cakedc, dobbiamo aggiungere un altro remote.
sempre nella cartella del submodule
[bash]
git remote add upstream git://github.com/CakeDC/categorie.git
[/bash]
&lt;h5&gt;Sincronizzare il nostro submodule con il repo originario forkato&lt;/h5&gt;
Per scaricare gli aggiornamenti
[bash]
git fetch upstream
[/bash]
Per fare un merge fra gli aggiornamenti appena scaricati da upstream ed il vostro repo in locale
[bash]
git merge upstream/master
[/bash]
Per capire la differenza tra &quot;git pull upstream&quot; e &quot;git fetch upstream&quot;, consiglio di leggere il punto &quot;Pull in upstream changes&quot; di questa &lt;a href=&quot;http://help.github.com/fork-a-repo/&quot;&gt;guida&lt;/a&gt;.
Qui un link su&lt;a href=&quot;http://stackoverflow.com/questions/3903817/how-to-pull-new-updates-for-forked-repository-in-github&quot;&gt; stackoverflow &lt;/a&gt;riguardante questa parte.
&lt;h5&gt;Rimuovere submodules&lt;/h5&gt;
Per rimuovere un submodule erronemente creato:
Delete the relevant line from the .gitmodules file.
Delete the relevant section from .git/config.
Run git rm --cached path_to_submodule (no trailing slash).
via &lt;a href=&quot;http://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule&quot;&gt;Stackoverflow&lt;/a&gt;
&lt;h5&gt;Clonare un progetto contenente submodules&lt;/h5&gt;
[bash]
git clone git://github.com/user/progettoconsubmodules.git
[/bash]
Questo clonera' il progetto e la cartella del submodule, ma non il contenuto di quest'ultima. Per farlo lanciamo:
[bash]
git submodule init
git submodule update
[/bash]
Altre info su questa parte nel &lt;a href=&quot;http://progit.org/book/ch6-6.html&quot;&gt;git pro book&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Jquery screensaver</title>
   <link href="http://username.github.com/2011/10/11/jquery-screensaver"/>
   <updated>2011-10-11T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/10/11/jquery-screensaver</id>
   <content type="html">Uno screensaver stile windows, fatto con jquery.
questo l'html
[html]
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
body{
	background-color:#b0c4de;
	margin:0px;
	width:100%;
}
#container{
	position: relative;
}
#saver{
	background-color:lime;
	width:100px;
	height:100px;
	position: fixed;
	z-index: 50;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id =&quot;container&quot;&gt;
		&lt;div id =&quot;saver&quot;&gt;I'm a screensaver
		&lt;/div&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
[/html]
Dopo la fine del tag &lt;pre&gt;head&lt;/pre&gt; inserite questo codice js
[javascript]
&lt;script&gt;
$(function(){
var savescreen = function(speed, vertical, horizontal){
	$(&quot;#saver&quot;).animate({left: '+='+horizontal, top: '+='+vertical}, speed);
	$(&quot;#saver&quot;).animate({left: '-='+horizontal, top: '+='+vertical}, speed);
	$(&quot;#saver&quot;).animate({left: '-='+horizontal, top: '-='+vertical}, speed);
	$(&quot;#saver&quot;).animate({left: '+='+horizontal, top: '-='+vertical}, speed);
};

$(function(){
	larg_saver = $('#saver').width();
	alt_saver = $('#saver').height();
	width = $(window).width();
	height = $(window).height();
	margin_top_saver = (height - alt_saver)/2;
	margin_left_saver = (width - larg_saver)/2;
	$('#saver').css('top',0);
	$('#saver').css('left',margin_left_saver);				
  });


window.setInterval(function(){
	speed = 1000
	savescreen(speed, margin_top_saver, margin_left_saver);
}, 1000);

});
&lt;/script&gt;
[/javascript]
Qui una demo per lo &lt;a href=&quot;/demo/screensaver.html&quot;&gt;screensaver&lt;/a&gt; in jquery
</content>
 </entry>
 
 <entry>
   <title>Git Branches</title>
   <link href="http://username.github.com/2011/09/20/git_branch"/>
   <updated>2011-09-20T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/09/20/git_branch</id>
   <content type="html">Per lo sviluppo di un progetto sto utilizzando git in locale con due branches. Un branch master/origin, dove risiede il lavoro pronto per essere caricato in produzione, e uno develop, su cui effettuo i commits, sviluppo nuove featurse, e, quando tutto va bene, implemento nel branch master/origin. Qui sotto un breve tutorial su come cominciare. Diamo per scontato di avere un repo inizializzato, con il branch master/origin. Per creare il nuovo branch 'develop'
[bash]
git branch develop
[/bash]
per vedere i vari branches
[bash]
git branch
[/bash]
l'asterisco indica il branch attualmente selezionato
per passare da un branch all'altro
[bash]
git checkout master
git checkout develop
[/bash]
Per portare avanti il codice su develop, selezioniamo il branch develop
[bash]
git checkout develop
[/bash]
andiamo avanti con i nostri commit che verranno eseguiti SOLO sul branch develop.
Difatti, se torniamo sul branch master e cerchiamo le modifiche appena fatte, non le troveremo perche' sono solo su develop.
quando le modifiche sono pronte per essere messe nel branch 'master', selezioniamolo
git checkout master
e diciamo al branch master di prendere le modifiche fatte su develop
[bash]
git merge develop
[/bash]
Una volta che le nuove modifiche sono state implementate, possiamo taggare il branch master con il corrente numero di versione
[bash]
git tag 0.1
[/bash]
se un giorno decidessimo che il branch develop non ci serve più, cancelliamolo 
[bash]
git branch -d develop
[/bash]

&lt;strong&gt;Differenze tra i due branches&lt;/strong&gt;
Può capitare che alcune modifiche fatte su 'develop' differiscano dal codice presente su master. Puoà darsi che abbiate innavertitamente lavorato su master per delle modifiche che dovevano essere effettuate su develop, o altri scenari simili. Quando, dal branch master lanciamo
[bash]
git merge develop
[/bash]
Le modifiche fatte su master vengono fuse alle modifiche fatte su develop. Se alcune di queste modifiche riguardano la stessa porzione di codice, al primo commit git ci segnalerà che dobbiamo risolvere un conflitto prima di proseguire.
[bash]
file_config.txt: needs merge
[/bash]
Apriamo il file incriminato, sistemiamolo e poi git add e git commit.
[bash]
git add file_config.txt
git commit
[/bash]
&lt;strong&gt;Il control-Z dell'ultimo merge&lt;/strong&gt;
Se avete appena fatto il merge sul branch master di una bizzarra feature che avevate sviluppato su develop, che credevate pronta e superefficiente ma in realtà ha scatenato un turbine di email di protesta da parte degli utenti che rivogliono indietro il loro vecchio sistema, dove &quot;tutto funzionava&quot;, dove &quot;tutto era più semplice&quot; e sentite che sta per arrivare la email &quot;si stava meglio quando si stava peggio&quot;, beh, allora, forse è meglio tornare indietro, e levare l'ultima feature aggiunta.
[bash]
git reset --hard ORIG_HEAD
[/bash]
Qui il &lt;a href=&quot;http://book.git-scm.com/3_basic_branching_and_merging.html&quot;&gt;tutorial completo&lt;/a&gt;
Per vedere tutti i commit fatti nei minimi dettagli, installate &lt;a href=&quot;http://lwn.net/Articles/140350/&quot;&gt;gitk&lt;/a&gt; e lanciatelo da console nella directory dove avete un progetto versionato
</content>
 </entry>
 
 <entry>
   <title>CakePHP 2.0 Authentication</title>
   <link href="http://username.github.com/2011/09/20/cakephp-2-0-authentication"/>
   <updated>2011-09-20T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/09/20/cakephp-2-0-authentication</id>
   <content type="html">Con CakePHP 2.0 ci sono tante novità. In questo post spiegherò come realizzare una semplice sistema di &lt;a href=&quot;http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html&quot;&gt;autenticazione&lt;/a&gt; per l'admin area, in cui abbiamo differenti users che possono accedervi, ma solo uno e' l'admin, gli altri sono amministratori con funzioni limitate. Per un piccolo sistema, con pochi utenti, ho deciso di non usare ACL, troppo ingombrante e dispendiosa, ma di scrivere un metodo apposito, allowedGroups da richiamare nelle azioni in cui voglio verificare che solo un determinato gruppo di utenti possa accedere a determinate funzioni. Alcune note sulle novità che influiscono sull'autenticazione.
&lt;ul&gt;
	&lt;li&gt;Sono supporati diversi tipi di autenticazione, configurabili tramite degli handlers, quello usato in questo articolo è il FormAuthenticate handler di default.&lt;/li&gt;
	&lt;li&gt;Nelle versioni precedenti di CakePHP 2.0 bastava aggiungere l'Auth Component e chiamare la funzione login nello user controller,  nella nuova versione, nella nostra function login, dovremo chiamare manualmente &quot;$this-&amp;gt;Auth-&amp;gt;login()&quot;&lt;/li&gt;
	&lt;li&gt;La password non viene più crittata di default, il metodo va chiamato manualmente&lt;/li&gt;
&lt;/ul&gt;
Creiamo un database per gli users e uno per i groups&lt;br&gt;
&lt;pre&gt;
CREATE TABLE IF NOT EXISTS `groups` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nome` varchar(70) NOT NULL,
  `description` text NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;

CREATE TABLE IF NOT EXISTS `users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `group_id` int(11) NOT NULL,
  `name` varchar(70) NOT NULL,
  `email` varchar(70) NOT NULL,
  `password` varchar(60) NOT NULL,
  `description` text NOT NULL,
  `created` datetime NOT NULL,
  `modified` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;
&lt;/pre&gt;&lt;br&gt;
Creiamo i relativi controllers, models e views usando &quot;cake bake&quot;.
Andiamo ad eliminare tutte le action e tutte le view che non saranno accessibili al di fuori dell'admin area. Rimuoviamo quindi,per esempio, dallo UserController le action delete, add, edit. Aggiungiamo i metodi per il login ed il logout dello user in app/Controllers/UsersController.php
[php]
/**
 * Users Controller
 *
 * @property User $User
 */
class UsersController extends AppController {
	public function beforeFilter() {
		parent::beforeFilter();
		$this-&gt;Auth-&gt;allow('admin_login');
	}
/**
 * login method
 *
 * @return void
 */
	public function admin_login() {
		if ($this-&gt;request-&gt;is('post')) {
			if ($this-&gt;Auth-&gt;login()) {
				$user_id = $this-&gt;Auth-&gt;user('id');
				$group_id = $this-&gt;Auth-&gt;user('group_id');
				$group = $this-&gt;User-&gt;getGroup($group_id);
				$this-&gt;Session-&gt;write('Auth.User.group', $group);		
				$this-&gt;redirect(array('action' =&gt; 'profile', $user_id, 
										'admin' =&gt; true));
			} else {
				$this-&gt;Session-&gt;setFlash(__('email o password errata'), 
											'default', array(), 'auth');
			}
		}
	}
/**
 * logout method
 *
 * @return void
 */
	public function admin_logout() {
        $this-&gt;Session-&gt;setFlash('Sei ora sloggato dal sistema');
		$this-&gt;Session-&gt;destroy();
		$this-&gt;redirect($this-&gt;Auth-&gt;logout());
	}
[/php]
Come vedete ho utilizzato il metodo getGroup, che dovro' scrivere nel mio App/Model/User.php
[php]
function getGroup($group_id){
	$conditions = array('id' =&gt; $group_id);		
	$group = $this-&gt;Group-&gt;field('nome', $conditions);		
	if ($group) {
		return $group;
	}
	else {
		return false;
	}		
}
[/php]

Passiamo ora all'AppController.php, richiediamo l'autenticazione per chiunque voglia accedere all'admin area, e creiamo in App/Views/Layouts il file admin.ctp che conterrà il layout specifico per l'admin. Inoltre, andiamo a scrivere nella sessione il nome del gruppo, in modo da poterlo sempre leggere nella variabile $current_user, e da poterlo utilizzare sia per decidere quali elementi nelle view mostrare, sia per verificare che il nome del gruppo sia nell'elenco delle funzioni che vogliamo restringere solo ad alcuni gruppi.
[php]
class AppController extends Controller {
	var $components = array('Auth','Session');
	var $helpers = array('Session','Form','Html');
    var $current_user = false;

    function beforeFilter() {
		if (isset($this-&gt;request-&gt;params['admin'])) {
            $this-&gt;layout = 'admin';
			$this-&gt;Auth-&gt;logoutRedirect = '/';		
			$this-&gt;Auth-&gt;authenticate = array(
				AuthComponent::ALL =&gt; array(
					'fields' =&gt; array(
						'username' =&gt; 'email',
						'password' =&gt; 'password'),
					'userModel' =&gt; 'Users.User'
				), 'Form'
			);
        } else {
            $this-&gt;Auth-&gt;allow();
        }		
        $this-&gt;current_user = $this-&gt;Auth-&gt;user();
    }

    function beforeRender() {
        $this-&gt;set('current_user',$this-&gt;current_user );
    }
	
	function allowGroups($groups = array(), $options = array()){
		if (empty($options['message'])) {
			$options['message'] = 'non sei autorizzato ad accedere';
		}
		
		$group = $this-&gt;Session-&gt;read('Auth.User.group');		
		if (in_array($group, $groups) || ($groups[0] == &quot;*&quot;)) {
			return true;
		} 
		else {
			$this-&gt;Session-&gt;setFlash(__($options['message']));
			$this-&gt;Session-&gt;destroy();
			$this-&gt;redirect($this-&gt;Auth-&gt;logout());

		}
	}	
}
[/php]
Creaimo il file Views/Users/admin_login.ctp
[php]
&lt;?
echo $this-&gt;Session-&gt;flash('auth');
echo $this-&gt;Form-&gt;create('User', array('url' =&gt; array('controller' =&gt; 'users', 'action' =&gt;'login')));
echo $this-&gt;Form-&gt;input('User.email', array('label'=&gt;'Email'));
echo $this-&gt;Form-&gt;input('User.password', array('label'=&gt;'password'));
echo $this-&gt;Form-&gt;end('Loggati');
?&gt;
[/php]
Qui sotto un esempio su come utilizzare allowGroups.
[php]
#se voglio autorizzare tutti i gruppi esistenti
$this-&gt;allowGroups(array('*'));
#se voglio autorizzare solo il gruppo admin
$this-&gt;allowGroups(array('admin'));
#se voglio autorizzare admin e supervisori
$this-&gt;allowGroups(array('admin','supervisori'));
[/php] 
</content>
 </entry>
 
 <entry>
   <title>php strtoupper umlauts</title>
   <link href="http://username.github.com/2011/08/15/php-strtoupper-umlauts"/>
   <updated>2011-08-15T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/08/15/php-strtoupper-umlauts</id>
   <content type="html">Strtoupper non funziona con i default local characters, come le umlauts.
Per risolvere questo problema si può usare preg_replace.
[php]
setlocale(LC_ALL, 'de_DE');
$title = 'viele umlauts, zum beispiel ä, ü, ö...und eine ß';
$umaluts = array('/ä/i','/ü/i','/ö/i','/ß/i');
$replacing_umlauts = array('Ä','Ü','Ö','SS');
$title = preg_replace($umaluts, $replacing_umlauts, $title);
echo strtoupper($title);  
[/php] 
</content>
 </entry>
 
 <entry>
   <title>Wordpress how to get ONE random image from the gallery</title>
   <link href="http://username.github.com/2011/08/05/wordpress-how-to-get-one-random-image-from-the-gallery"/>
   <updated>2011-08-05T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/08/05/wordpress-how-to-get-one-random-image-from-the-gallery</id>
   <content type="html">Tramite lo &lt;a href=&quot;http://codex.wordpress.org/Gallery_Shortcode&quot;&gt;shortcode gallery&lt;/a&gt; e' possibile inserire una galleria nel nostro tema personalizzato senza alcun problema. Per poter pero' estrarre un'immagine random dalla galleria e mostrarla nella larghezza desiderata dobbiamo scrivere un metodo apposito, perche' non vi sono opzioni sufficienti nello shortcode di default (si, esistono tanti plugin che permettono di avere un'immagine random senza scrivere una linea di codice....ma che noia!)
[php]
/*
 * find a random image from the gallery, that is related to a post
 */
function get_random_image_from_gallery($custom_width) {
	$query = new WP_Query(array(
		'showposts' =&gt; 1,
		'post_type' =&gt; array('attachment'),
		'post_status' =&gt; 'inherit',
		'meta_query' =&gt; array(array(
			'key' =&gt; '_wp_attached_file',
			'value' =&gt; '',
			'compare' =&gt; '!='
		)),
		'orderby' =&gt; 'rand'
	));	
	if($query-&gt;have_posts()) : while ($query-&gt;have_posts()) : $query-&gt;the_post();
		$image_attributes = wp_get_attachment_image_src(get_the_ID(), 'large');
		$width = $image_attributes[1];			
		$height = $image_attributes[2];			
		$resize_factor = $custom_width/$image_attributes[1];
		$relative_height = $resize_factor * $image_attributes[2]; 
		?&gt;&lt;img src=&quot;&lt;?php echo $image_attributes[0] ?&gt;&quot; 
			width=&quot;&lt;?= $custom_width?&gt;px&quot; 
			height=&quot;&lt;?= ceil($relative_height)?&gt;px&quot;/&gt;
		&lt;?
	endwhile;
 	else: ?&gt;
		&lt;p class=&quot;empty&quot;&gt;&lt;?php _e(no images found.'); ?&gt;&lt;/p&gt;
	&lt;?php endif;		
}
[/php] 
</content>
 </entry>
 
 <entry>
   <title>Ruby on Rails themes generator</title>
   <link href="http://username.github.com/2011/07/24/ruby-on-rails-themes-generator"/>
   <updated>2011-07-24T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/07/24/ruby-on-rails-themes-generator</id>
   <content type="html">Questa gemma leva un sacco di castagne dal fuoco. Aggiungere stili e classi ad un'applicazione fatta prevalentemente da form e' decisamente noioso.
&lt;a href=&quot;https://github.com/pilu/web-app-theme&quot;&gt;web-app-theme&lt;/a&gt; e' la gemma che fa al caso nostro.
Aggiungete al vostro Gemfile (su rails 3)
[ruby]
group :development, :test do
  gem 'web-app-theme', '&gt;= 0.6.2'
end
[/ruby]
poi
[ruby]
bundle install
[/ruby]
e scegliete quale tema installare. &lt;a href=&quot;http://pilu.github.com/web-app-theme/#themes/drastic-dark&quot;&gt;Qua&lt;/a&gt; una lista con i relativi esempi.
[ruby]
rails g web_app_theme:theme --theme=&quot;drastic-dark&quot; --app-name=&quot;Nome della mia app&quot;
[/ruby]
via &lt;a href=&quot;http://blog.bryanbibat.net/2011/01/03/starting-a-professional-rails-app-with-haml-rspec-devise-and-web-app-theme/&quot;&gt;bryanbibat&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Ruby on Rails Devise authentication</title>
   <link href="http://username.github.com/2011/07/24/ruby-on-rails-devise-authentication"/>
   <updated>2011-07-24T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/07/24/ruby-on-rails-devise-authentication</id>
   <content type="html">Aggiungete devise nel vostro Gemfile e lanciate &quot;bundle install&quot;.
Ora create i file di configurazione necessari:
[ruby]
rails generate devise:install
[/ruby]
Definite l'url che verra' utilizzata per i link di conferma sulle email di registrazione. In configurations/environments/development.rb
[ruby]
#Devise email
config.action_mailer.default_url_options = { :host =&amp;gt; 'localhost:3000' }
[/ruby]
Creiamo il file di migrazione e lo user model
[ruby]
rails generate devise User
[/ruby]
Nello User model appena creato Models/user.rb , possiamo scegliere quali moduli includere od escludere, semplicemente togliendo quelli di default o aggiungendo quelli presenti nel commento del file user.rb.  A mio avviso quelli di default vanno piu' che bene.
[ruby]
class User &amp;lt; ActiveRecord::Base
# Include default devise modules. Others available are:
# :token_authenticatable, :confirmable, :lockable and :timeoutable :recoverable,
devise :database_authenticatable, :registerable,
:rememberable, :trackable, :validatable

# Setup accessible (or protected) attributes for your model
attr_accessible :email, :password, :password_confirmation, :remember_me
end
[/ruby]
Ora aprite il file Migrations/***devise_create_users.rb e commentate o aggiungete i moduli che avete aggiunto to tolto nello User Model. Poi fate la migrazione.
[ruby]
rake db:migrate
[/ruby]
Con &quot;rake routes&quot; potete vedere tutte le routes messe a disposizione dalla vostra applicazione. Trovo questo comendo davvero molto utile, anche nel debug di un applicazione, o quando vogliamo verificare che ogni action abbia la sua view ben fatta.Un'altra cosa che cakePHP non ha (cominciano ad essere tante).
Ora se puntate il browser alla seguente url /users/sign_in potrete loggarvi. Per registrarvi andate qui /users/sign_up. Io ho incontrato il seguente errore:
[ruby]
No route matches &quot;/users/sign_up&quot;
[/ruby]
Per risolverlo ho definito lo scope nel file routes, come spiegato qui &lt;a href=&quot;http://stackoverflow.com/questions/2349604/using-devise-with-rails-3-beta&quot;&gt;http://stackoverflow.com/questions/2349604/using-devise-with-rails-3-beta&lt;/a&gt;
Per visualizzare i messaggi d'errore nella vostra applicazione, aggiungete queste linee di codice nel vostro application.html.erb.
[ruby]
&lt;%- flash.each do |name, msg| -%&gt;
  &lt;%= content_tag :div, msg, :id =&gt; &quot;flash_#{name}&quot; if msg.is_a?(String) %&gt;
&lt;%- end -%&gt;
[/ruby]

Sempre in application.html.erb, aggiungete i link alle azioni sign_in e sign_out. Scoprite i relativi path attraverso &quot;rake routes&quot; e aggiungete questo codice dopo il tag body:
[ruby]
&lt;div id=&quot;user_nav&quot;&gt;signed in as&lt;/div&gt;
[/ruby]
Per circoscrivere il raggio d'azione di un utente non loggato all'interno della nostra applicazione, definiamo quali azini sono ad esso concesse. Poniamo il caso che solo un utente loggato puo' creare o modificare un post, mentre l'utente sloggato puo' solo vederli.
Nel nostro &quot;posts_controller&quot; aggiungiamo la seguente funzione:
[ruby]
before_filter :authenticate_user!, :except =&amp;gt; [:index, :show]
[/ruby]
Per modificare le views di devise, lanciamo &quot;rails g devise:views&quot;, ed otterremo un output simile a questo:
[ruby]
create app/views/devise
create app/views/devise/confirmations/new.html.erb
create app/views/devise/mailer/confirmation_instructions.html.erb
create app/views/devise/mailer/reset_password_instructions.html.erb
create app/views/devise/mailer/unlock_instructions.html.erb
create app/views/devise/passwords/edit.html.erb
create app/views/devise/passwords/new.html.erb
create app/views/devise/registrations/edit.html.erb
create app/views/devise/registrations/new.html.erb
create app/views/devise/sessions/new.html.erb
create app/views/devise/shared/_links.erb
create app/views/devise/unlocks/new.html.erb
[/ruby]
Modifichiamo i seguenti file a nostro piacimento. Se vogliamo modificare i messaggi d'errore, mettiamo mano al file config/locales/devise_en.yml. Se invece vogliamo modificare le regole di controllo per la registrazione (es passare da &quot;Password is too short (minimum is 6 characters)&quot; a &quot;Password is too short (minimum is 8 characters)&quot;) modifichiamo il file initializers/devise.rb.
Per modificare le URL di default con le quali avvengono le azioni di login e logout, apriamo il file routes.rb
[ruby]
devise_for :users, :path_names =&amp;gt; {:sign_in =&amp;gt; &quot;login&quot;, :sign_up =&amp;gt; &quot;logout&quot;}
[/ruby].
Il nostro futuro user si logga inserendo email e password, come fare se in futuro ci venisse richiesto di sostituire il campo email con il campo username? prima di tutto aggiungiamo la colonna necessaria:
[ruby]
rails generate migration AddUsernameToUsers username:string
rake db:migrate
[/ruby]
Ora in config/initializers/devise.rb aggiungiamo
[ruby]
config.authentication_keys = [ :username ]
[/ruby]
Questo tutorial e' tratto dai seguenti railcasts:
&lt;a href=&quot;http://railscasts.com/episodes/209-introducing-devise&quot;&gt;http://railscasts.com/episodes/209-introducing-devise&lt;/a&gt;
&lt;a href=&quot;http://railscasts.com/episodes/210-customizing-devise&quot;&gt;http://railscasts.com/episodes/210-customizing-devise&lt;/a&gt;
Qua la &lt;a href=&quot;https://github.com/plataformatec/devise/wiki&quot;&gt;pagina del progetto su github&lt;/a&gt;.
</content>
 </entry>
 
 <entry>
   <title>Netbeans e PHPUnit</title>
   <link href="http://username.github.com/2011/07/18/netbeans-e-phpunit"/>
   <updated>2011-07-18T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/07/18/netbeans-e-phpunit</id>
   <content type="html">Dopo aver verificato che anche&lt;a href=&quot;http://blog.enebo.com/2011/02/installing-ruby-support-in-netbeans-70.html&quot;&gt; NetBeans 7 supporta Ruby&lt;/a&gt;, ho deciso di aggiornarlo. La prima cosa che  ho configurato e' il supporto a PHPUnit. In questo ultimo mese ho scritto tests per un applicazione in CakePHP (post a breve a rigurardo) e ho trovato parecchi link a PHPUnit, che e' il framework di testing per CakePHP 2.0.

Su Debian/Ubuntu derivate lanciate da console:
[bash]
apt-get install phpunit
[/bash]
Ora aprite Netbeans, andate in Tools-&amp;gt;Options-&amp;gt;PHP-&amp;gt;Unit Testing.
Nel campo PHPUnit script inserite il valore &quot;/usr/bin/phpunit&quot;.
Cliccate OK e chiudete.

Ora quando cliccate con il tasto destro su un file nel vostro project tree, alla voce Tools vi comparira' l'opzione &quot;create PHPUnit tests&quot;. Scegliete la cartella nella quale volete che il vostro file di test venga generato e confermate.

Per lanciare il test, premete CTRL+F6, o cliccate con il tasto destro sul file e scelgiete la voce &quot;Test&quot;. Maggiori info a riguardo a questo &lt;a href=&quot;http://netbeans.org/kb/docs/php/phpunit.html&quot;&gt;link&lt;/a&gt;.

Qui invece il sito di PHPUnit, con tutte le assertions &lt;a href=&quot;http://www.phpunit.de/manual/current/en/writing-tests-for-phpunit.html#writing-tests-for-phpunit.assertions&quot;&gt;disponibili&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>CakePHP submit form json reply</title>
   <link href="http://username.github.com/2011/07/13/cakephp-submit-form-json-reply"/>
   <updated>2011-07-13T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/07/13/cakephp-submit-form-json-reply</id>
   <content type="html">In severa ottemperanza del paradigma MVC, ogni dogmatico cakePHP developer ripudia la risposta ad una chiamata in ajax stampata direttamente nel controller. Vediamo quindi come utlizzare la view appropriata per non fare inorridire il piu' oltranzista dei cakePHP developer.
poniamo di inviare il nostro form &quot;#MioForm&quot; all'action &quot;MiaAction&quot; e voler visualizzare la risposta nel &quot;MioDiv&quot;. Il codice javascript (utilizziamo jquery, ovvio) e' questo.
[javascript]
$.ajax({
	url: '/bookings/MiaAction',
	type: 'POST',
	data: $('#MioForm').serialize(),
	dataType: 'json',
	success: function(response) {
		$('#MioDiv').val(response.first_value);
	}
});
[/javascript] 
Il nostro controller sara' cosi'.
[php]
function MiaAction(){
	$this-&gt;view = 'Json';
	$json = array(
		'first_value' =&gt; 'Yes, i am the first value',
		'second_value' =&gt; 'No, i am the third value',
	);
	$this-&gt;set(compact('json'));
}
[/php]
Notate la view 'Json'. Questa fa si che il vostro output sia formattato correttamente. Create un file chiamato json.php, aggiungetelo in app/views e copiate al suo interno la classe JsonView  che trovate a questo indirizzo &lt;a href=&quot;http://nuts-and-bolts-of-cakephp.com/tag/cakephp-json/&quot;&gt;http://nuts-and-bolts-of-cakephp.com/tag/cakephp-json/&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>git in locale</title>
   <link href="http://username.github.com/2011/06/26/git-in-locale"/>
   <updated>2011-06-26T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/06/26/git-in-locale</id>
   <content type="html">non necessariamente un progetto web deve avere l'origin su un server in remoto.
per settare la vostra origin in locale, dopo aver inizializzato il vostro repo, per esempio in /home/me/projektOne, creiamo una cartella /home/me/allMyGitsProject/projecktOne.git, al suo interno e digitiamo
[bash]
git init --bare
[/bash]
Ora ritonrniamo nella cartella contenente il nostro codice versionato /home/me/projectOne
e diciamo a git che l'origin di questo progetto è in /home/me/allMyGitsProject
[bash]
git remote add origin /home/me/allMyGitsProject/projectOne.git
[/bash]
ora possiamo effettuare il push
[bash]
git push origin master
[/bash] 
</content>
 </entry>
 
 <entry>
   <title>git-ftp e alias</title>
   <link href="http://username.github.com/2011/06/26/git-ftp-e-alias"/>
   <updated>2011-06-26T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/06/26/git-ftp-e-alias</id>
   <content type="html">Quasi tutti i progetti su cui lavoro sono sotto git. La necessità di caricare sul server ftp gli ultimi commits mi ha portato a scoprire &lt;a href=&quot;https://github.com/resmo/git-ftp&quot;&gt;git-ftp&lt;/a&gt;. Si &lt;a href=&quot;https://github.com/resmo/git-ftp/blob/develop/INSTALL.md&quot;&gt;installa&lt;/a&gt; su Mac,Win e Linux.
Per installare il pacchetto su debian, consiglio di &lt;a href=&quot;http://blog.anantshri.info/howto-add-ppa-in-debian/&quot;&gt;aggiungere&lt;/a&gt; il &lt;a href=&quot;https://launchpad.net/~resmo/+archive/git-ftp&quot;&gt;ppa&lt;/a&gt; ubuntu dello sviluppatore ed &lt;a href=&quot;http://stream-recorder.com/forum/w-gpg-error-http-ppa-launchpad-net-t6741.html&quot;&gt;importare la chiave&lt;/a&gt; in modo da avere sempre il pacchetto aggiornato.
Per configurare le credenziali di accesso bisogna:
[bash]
$ git config git-ftp.user john
$ git config git-ftp.url ftp.example.com/myfolder
$ git config git-ftp.password secr3t
[/bash]
poi per caricare il tutto
[bash]
$ git ftp push
[/bash]
Se non riuscite a connettervi, verificate che il firewall del vostro hosting non stia bloccando cURL. In ogni caso, gli sviluppatori stanno lavorando ad una nuova versione che utilizza lftp invece che cURL.

Dopo aver fatto questo, veniamo agli &lt;a href=&quot;http://www.catonmat.net/blog/git-aliases/&quot;&gt;alias&lt;/a&gt; per git.
Questi sono quelli che ho aggiunto io al mio file .bashrc
[bash]
alias ga='git add'
alias gp='git push'
alias gfp='git ftp push'
alias gl='git log'
alias gs='git status'
alias gd='git diff'
alias gdc='git diff --cached'
alias gm='git commit -m'
alias gma='git commit -am'
alias gb='git branch'
alias gc='git checkout'
alias gra='git remote add'
alias grr='git remote rm'
alias gpu='git pull'
alias gcl='git clone'
alias glast='git show --pretty=&quot;format:&quot; --name-only'
[/bash]
L'ultimo alias elenca i file modificati nell'ultimo commit effettuato.
</content>
 </entry>
 
 <entry>
   <title>Mp3 file types</title>
   <link href="http://username.github.com/2011/05/19/mp3-file-types"/>
   <updated>2011-05-19T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/05/19/mp3-file-types</id>
   <content type="html">Ho dovuto realizzare un uploader utlizzando questo &lt;a href=&quot;http://www.webtechnick.com/blogs/view/221/CakePHP_File_Upload_Plugin&quot;&gt;plugin &lt;/a&gt; nel quale si possono specificare quali tipi di file e' possibile caricare. L'applicazione si concentra sui file audio, da qui la necessita' di elencare i filetypes consentiti. Non ho ancora trovato una lista completa, non pensavo fossero cosi' tanti e ogni giorno un utente me ne segnala uno nuovo. Ecco l'elenco, spero possa risparmiare tempo a qualcuno.
[php]
'allowedTypes' =&gt; array('mp3' =&gt; array('audio/mp3',
										'audio/mpeg',
										'audio/mpg',
										'audio/x-amzaudio',
										'audio/x-mp3',
										'audio/mpeg3',
										'audio/x-mpeg3',
										'audio/x-mpeg',
										'audio/x-mpg',
										'audio/mpeg3',
										'audio/x-mpegaudio'
									),
						'ogg' =&gt; array('audio/x-vorbis+ogg',
										'audio/x-ogg',
										'application/x-ogg',
										'application/ogg'
										)
),
[/php] 
</content>
 </entry>
 
 <entry>
   <title>LXDE cambiare layout tastiera</title>
   <link href="http://username.github.com/2011/05/14/lxde-cambiare-layout-tastiera"/>
   <updated>2011-05-14T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/05/14/lxde-cambiare-layout-tastiera</id>
   <content type="html">LXDE è un desktop leggero che proprio per la sua leggerezza spesso manca di tool grafici &quot;comodi&quot;.
Ad esempio poter cambiare il layout della tastiera al volo in xfce c'è un bellissimo aggeggio che fa tutto.
Su LXDE no. Siccome a me piace un desktop leggero(no gnome/ no kde) ma non mi piace perdere ORE sulla riga di comando, ho configurato il mio desktop così, senza una riga di gnome.
Installare &lt;a href=&quot;http://fbxkb.sourceforge.net/faq.html&quot;&gt;fbxkb&lt;/a&gt; e poi lanciare da console questo comando
&lt;pre&gt;
setxkbmap -option grp:switch,grp:shifts_toggle,grp_led:scroll us,de,it
&lt;/pre&gt;
Sostituite us, de o it con le lingue che preferite.
Aggiungete il comando nel file .bashrc, in modo da caricarlo ad ogni avvio.

Una volta fatto questo (copio e incollo dal wiki di LXDE):
Right-click on your taskbar
Choose “Add / Remove Panel Items”
Choose “Add”
Choose “Keyboard Layout Switcher”

Fatto. Cambiare lingua è ancora più veloce che con xfce.
</content>
 </entry>
 
 <entry>
   <title>CakePHP emails non visualizzate correttemente in Squirrelmail o Roundcube</title>
   <link href="http://username.github.com/2011/05/12/cakephp-email-non-visualizzate-correttemente-in-squirrelmail-o-roundcube"/>
   <updated>2011-05-12T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/05/12/cakephp-email-non-visualizzate-correttemente-in-squirrelmail-o-roundcube</id>
   <content type="html">Se el email spedite dalla vostra applicazione non vengono visualizzate correttamente in programmi come squirrelmail o roundcube, bisogna aggiungere questa porzione di codice prima dell'invio.
[php]
$this-&gt;Email-&gt;__header[] = 'MIME-Version: 1.0';
$this-&gt;Email-&gt;from = 'Sprecher &lt;info@eintsprecher.de&gt;';
[/php]
Via &lt;a href=&quot;http://www.pixelastic.com/blog/230:displaying-html-mails-sent-from-cakephp-in-squirrelmail&quot;&gt;http://www.pixelastic.com/blog/230:displaying-html-mails-sent-from-cakephp-in-squirrelmail&lt;/a&gt;

&lt;a href=&quot;http://cakephp.lighthouseapp.com/projects/42648-cakephp/tickets/14-email-component-should-set-mime-version-header-when-sendas-html-or-both&quot;&gt;http://cakephp.lighthouseapp.com/projects/42648-cakephp/tickets/14-email-component-should-set-mime-version-header-when-sendas-html-or-both&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>CakePHP check the owner</title>
   <link href="http://username.github.com/2011/05/12/cakephp-check-the-owner"/>
   <updated>2011-05-12T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/05/12/cakephp-check-the-owner</id>
   <content type="html">&lt;strong&gt;update cake 2.0&lt;/strong&gt;: $this-&gt;request-&gt;is('ajax') invece del vecchio RequestHandler. 
Capita spesso di dover verificar il proprietario di un item prima di modificarlo.
In cakePHP non esiste (per ora) un metodo dedicato a tale scopo. Cosa abbastanza strana, visto che la convenzione di associare lo User Model ad un altro Model tramite il campo user_id e' esiste da parecchio tempo.
Ho scritto un metodo da inserire nell'app_controller che permette di verificare che l'utente che modifica un iteme sia effettivamente il proprietario. Il metodo e' flessibile e puo' essere utilizzato con qualunque modello sia associato alla tabella Users tramite il campo user_id.

[php]
    function _isOwner($data, $options = array()){
	    if (empty($options['message'])) {
			$flash_message = &quot;You are not allowed to access to this area&quot;;
	    }
	    else {
			$flash_message = $options['message'];
	    }

	    if (empty($options['scope'])) {
			$scope = $this-&gt;modelClass;
	    }
	    else {
			$scope = $options['scope'];
	    }

	    if (empty($options['redirect'])) {
			$redirect = false;
	    }
	    else {
			$redirect = $options['redirect'];
	    }

	    if ($scope == 'User') {
			$user_field = &quot;id&quot;;
	    }
	    else {
			$user_field = &quot;user_id&quot;;
	    }
	    $current_user = $this-&gt;Session-&gt;read('Auth.User.id');
	    if ($data[$scope][$user_field] == $current_user) {
		    return true;
	    }
	    else {
		    if ($redirect) {
			    $this-&gt;Session-&gt;setFlash($flash_message, 'error');
				//RequestHandler-&gt;isAjax() is buggy
			    if($this-&gt;request-&gt;is('ajax')) {
			    	$this-&gt;set('success', false);
			    	$this-&gt;set('error', $flash_message);
			    }
			    else {
			    	$this-&gt;redirect($redirect);
			    }
		    }
		    return false;
	    }
    }
[/php]

Qualche esempio pratico:
[php]
$post = $this-&amp;gt;Post-&amp;gt;findById($post_id);
$this-&amp;gt;_isOwner($post, array('redirect'=&amp;gt;'/'));
[/php]
Se l'utente loggato non e' il proprietario del post esso verra reindirizzato alla root.
Se invece un utente vuole modificare il proprio profilo all'indirizzo sito.com/users/edit/3 il campo da verificar enon sara' piu' 'user_id' ma l'id del modello 'User'. Per fare questo dobbiamo solo aggiungere impostare il parametro 'scope'.
[php]
$user = $this-&amp;gt;-&amp;gt;User-&amp;gt;findById($id);
$this-&amp;gt;_isOwner($user, array('scope'=&amp;gt; 'User'))
[/php]
Oltre a scope, gi altri parametri che si possono passare a questa funzione sono:
&lt;strong&gt;message&lt;/strong&gt; = Il messaggio che vogliamo mostrare dopo il redirect nel caso non ci vada bene quello di default
&lt;strong&gt;redirect = &lt;/strong&gt;L'url alla quale vogliamo reindirizzare l'utente. Se questo falore non e' impostato, la funzione restituira' solo TRUE o FALSE senza effettuare il redirect.
</content>
 </entry>
 
 <entry>
   <title>contare caratteri con umlaut con php</title>
   <link href="http://username.github.com/2011/04/19/contare-caratteri-con-umlaut-con-php"/>
   <updated>2011-04-19T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2011/04/19/contare-caratteri-con-umlaut-con-php</id>
   <content type="html">Non riuscivo a capire come mai uno stesso calcolo che comprendeva la misurazione dei caratteri componenti una stringa desse risultati diversi se eseguito in php o javascript. Dopo aver perso un sacco di tempo a verificare dove fosse l'incongruenza, scopro che strlen si prendeva gioco di me.
[php]
$string = &quot;ÄÄüü&quot;;
echo strlen($string); //8!!
[/php]
La umalut (e in generale tutti i caratteri multibyte) non viene letta come ci si aspetta.
Per ovviare a questo, usiamo utf8_decode
[php]
echo strlen(utf8_decode($string)); //4 
[/php] 
</content>
 </entry>
 
 <entry>
   <title>debian spacca</title>
   <link href="http://username.github.com/2011/02/07/debian-spacca"/>
   <updated>2011-02-07T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2011/02/07/debian-spacca</id>
   <content type="html">sempre.
aprire sources.list con vim, e da li
[bash]
%s/squeeze/wheezy/g
[/bash]
poi
[bash]
aptitude update
aptitude safe-upgrade
[/bash] 
</content>
 </entry>
 
 <entry>
   <title>Parsing dei link da un file html con Ruby e Nokogiri</title>
   <link href="http://username.github.com/2011/01/13/parsing-dei-link-da-un-file-html-con-ruby-e-nokogiri"/>
   <updated>2011-01-13T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2011/01/13/parsing-dei-link-da-un-file-html-con-ruby-e-nokogiri</id>
   <content type="html">&lt;a href=&quot;http://nokogiri.org/&quot;&gt;Nokogiri&lt;/a&gt; è una fantastica libreria di ruby che consente di parsare dei file. E' molto intuitiva, e permette di trovare velocemente la soluzione senza necessariamente conoscerla a fondo.
Per esempio, se voglio trovare i link di un documento html:
[ruby]
#/usr/bin/ruby
require 'rubygems'
require 'nokogiri'

f = File.open(&quot;home.html&quot;)
@doc = Nokogiri::HTML(f)
links = @doc.xpath(&quot;//a&quot;)
links.each do |l|
	p(l)
end
[/ruby]
La libreria utilizza xpath, trova il tag &quot;a&quot; e lo mette nel node &quot;l&quot;. Il risultato può apparire a prima vista confuso.
In realtà, una volta capito il concetto di &lt;a href=&quot;http://nokogiri.org/Nokogiri/XML/Node.html&quot;&gt;node&lt;/a&gt; tutto appare chiaro. Stampiamo quindi a video il percorso assoluto dei link:
[ruby]
#/usr/bin/ruby
require 'rubygems'
require 'nokogiri'

f = File.open(&quot;home.html&quot;)
@doc = Nokogiri::HTML(f)
links = @doc.xpath(&quot;//a&quot;)
links.each do |l| 
	print(l['href']+&quot;\n&quot;)
end
[/ruby] 
</content>
 </entry>
 
 <entry>
   <title>CakePHP e MongoDB</title>
   <link href="http://username.github.com/2010/12/28/cakephp-e-mongodb"/>
   <updated>2010-12-28T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/12/28/cakephp-e-mongodb</id>
   <content type="html">Piccola premessa, non tutte le applicazioni possono ricevere vantaggi dall'utilizzo di mongodb.
Alcune caratteristiche di MongoDb:
-&amp;Egrave; scritto in c
-Schema Free!! non necessita di uno schema fisso, ogni record ha il proprio schema. Inoltre, non dobbiamo definire nulla prima di inserire.
- salva i campi ogni volta che salvi un record, quindi campi corti riducono il peso del vostro database (o collection)
Queste le caratteristiche di MongoDB:
-Embedded Objects. Se ho un record (o document, come vedremo poi, la terminologia in mongo db varia da quella di mysql) contenente uno user con il campo &quot;address&quot;, il campo &quot;address&quot; puo' essere definito dal document Address, con una via ed un numero civico. Accoppiare gli oggetti User e Address assomiglia a fare una join fra le due tabelle in mysql.

&lt;strong&gt;Non va bene per&lt;/strong&gt;:
-Apllicazioni che necessitano funzioni di Join o Transaction.
-Server con poco spazio, questo avviene perchè ogni valore viene salvato con la propria label. Un normale database Mysql è più leggero.
&lt;strong&gt; Va bene per:&lt;/strong&gt;
-Applicazioni che richiedono velocità in scrittura e lettura
-Applicazioni che richiedono buona scalabilità

Installiamo php5-dev. Dopo di che lanciamo dalla console
[bash]pecl install mongo[/bash].  Se utilizzate windows...be, vi attaccate.
Modificate il vostro /etc/php5/apache2/php.ini e inserite nella sezione delle extensions la seguente linea [bash]extension=mongo.so[/bash]
Riavviate apache. A questo link potete trovare il pratico &lt;a href=&quot;http://us2.php.net/mongo&quot;&gt;manuale di mongo su php&lt;/a&gt;.
Ora, spostatevi nell'applicazione in cui volete utilizzare mongo db, e scaricatevi il plugin dello sviluppatore giapponese Ichikawa. &lt;a href=&quot;http://cake.eizoku.com/blog/&quot;&gt;Ichikawa&lt;/a&gt; spacca, qui il &lt;a href=&quot;http://tv.cakephp.org/video/CakeFoundation/2010/12/24/yasushi_ichikawa_-_how_to_use_mongodb_with_cakephp&quot;&gt;video&lt;/a&gt; dal quale è tratto questo tutorial.
[bash]
cd app/plugins
git clone http://github.com/ichikaway/mongoDB-Datasource.git mongodb
[/bash]
poi, modifichiamo il file app/config/database.php con dei dati fittizi.
[php]	var $default = array(
'driver' =&amp;gt; 'mongodb.mongodbSource',
'password' =&amp;gt; 'password',
'database' =&amp;gt; 'cakemongo1',
'port' =&amp;gt; '27017',
);
[/php]
Ora, copiamo le cartelle views, controllers e models presenti in /app/plugins/mongodb/samples  in app. Aprite Il file app/models/post.php e decommentate la variabile mongoSchema. Apriamo il nostro  browser a questo indirizzo &lt;a href=&quot;http://localhost/posts&quot;&gt;http://localhost/posts&lt;/a&gt; e clicchiamo su &quot;add data&quot; andando cosi' ad aggiungere il primo &quot;document&quot; (in mongodb row diventa document, column diventa field e database collection. Per altri preziosi parallelismi com mysql, date un occhio a &lt;a href=&quot;http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart&quot;&gt;Sql to Mongo Mapping chart&lt;/a&gt;).
Ora da console controlliamo i dati inseriti.

[bash]
da@lungimiranza:~$ mongo
show dbs
use cakemongo1
show collections
db.posts.find()
[/bash]

Come risultato otteremo qualcosa di simile
[bash]
{ &quot;_id&quot; : ObjectId(&quot;4d1a0a4776aa08bb22000000&quot;), &quot;title&quot; : &quot;regfwerg&quot;, &quot;body&quot; : &quot;ertgertg&quot;, &quot;hoge&quot; : &quot;ertgertg&quot;, &quot;modified&quot; : &quot;Tue Dec 28 2010 17:03:19 GMT+0100 (CET)&quot;, &quot;created&quot; : &quot;Tue Dec 28 2010 17:03:19 GMT+0100 (CET)&quot; }[/bash].

Ora lasciamo perdere cakephp, diamo un occhio ad un altra cosa davvero belle in MongoDB. Geospatial index.
Geospatial ci permette di gestire facilmente una collection di coordinate. &lt;a href=&quot;http://www.mongodb.org/display/DOCS/Geospatial+Indexing&quot;&gt;Qua&lt;/a&gt; maggiori info a riguardo.
All'interno di questo esempio vengono utilizzati i seguenti operatori.
$near per trovare un punto vicino ad un altro
$box per trovare i punti all'interno di un rettangolo
$center per trovare punti all'interno di un cerchio
Salviamo due coordinate dalla console, ricordiamoci che in mongo db non abbiamo bisogno di definire uno schema prima di inserirre dati.
[bash]
db.geotest.save({ loc:[23,113] })
[/bash]
poi diamo un indice alla collection, in questo caso 2d, che sta per 2 dimensions
[bash]db.geotest.ensureIndex({ loc:&quot;2d&quot;})[/bash]
Ora inseriamo un centinaio di punti, sempre da console
[bash]for(i=0; i&amp;lt;100; i++) (db.geotest.save ({loc:[i,i]}))[/bash]
verifichiamo di avere inserito tutto
[bash]db.geotest.find()[/bash]
Proviamo ad utilizzare gli operatori citati prima per identificare un punto.
[bash]db.geotest.find( { loc : { $near : [50,50] } } )[/bash]
Aggiungere un limite alla nostra ricerca in mongodb viene intuitivo
[bash]db.geotest.find( { loc : { $near : [50,50] } } ).limit(6)[/bash]
Troviamo i nostri punti all'interno di un rettangolo
[bash]db.geotest.find( { loc : { $within : { $box : [[1,1],[5,5]] } } } )[/bash]
O partendo da un punto
[bash]db.geotest.find( { loc : { $within : { $center : [[4,4],0.1] } } } )[/bash]
Il secondo valore definisce il raggio, se lo aumentate avrete logicamente un maggior numero di risultati
[bash]db.geotest.find( { loc : { $within : { $center : [[4,4],5] } } } )[/bash] 
</content>
 </entry>
 
 <entry>
   <title>Implementare Security Component e SSL con CakePHP</title>
   <link href="http://username.github.com/2010/12/09/implementare-security-component-e-ssl-con-cakephp"/>
   <updated>2010-12-09T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/12/09/implementare-security-component-e-ssl-con-cakephp</id>
   <content type="html">CakePHP mette a disposizione un component che permette di rendere la nostra applicazione sicura, per quanto possa essere sicura un applicazione accesibile dal browser, chiaro.
Vediamo come far sì che il nostro sito sia accessibile solo da https:// e non da http://, e come rendere i nostri form sicuri, non editabili con firebug.

Il security component è già nella core di cakePHP, quindi per abilitarlo non dobbiamo fare altro che aggiungere i components necessari in app_controller.php
[php]
var $components = array(
	'Security',
	'RequestHandler'
);
[/php]
 e mettere questa funzione, sempre nel nostro app_controller.php
[php]
	function beforeFilter(){
		$this-&gt;Security-&gt;requireSecure();
		$this-&gt;Security-&gt;blackHoleCallback = 'invalid';
	}
[/php]
La funzione requireSecure() obbliga il client ad utilizzare ssl, la proprietà validatePost invece dice che i nostri form vanno validati prima di essere processati, infine blackHoleCallback raccoglie tutte le richieste sporche, quelle che non soddisfano le nostre esigenze di sicurezza. Vediamo nel dettaglio la funzione invalid e forceSSL, entrambe all'interno dell'app_controller.php
[php]
	function invalid() {
		if(!$this-&gt;RequestHandler-&gt;isSSL()) {
			$this-&gt;forceSSL();
		}else{
			$this-&gt;cakeError('accessDenied');
		}	
	}

	function forceSSL() {
		$this-&gt;redirect('https://' . env('SERVER_NAME') . $this-&gt;here);
	}
[/php]
La funzione invalid separa le richieste, quelle che non sono su ssl vengono passate a forceSSL, che provvede
ad indirizzare tutte le richieste su https://, quelle che invece provengono da https:// ma presentano dati alterati maliziosamente, vengono inviate a cakeError('accessDenied'). QUesta funzione presenta un messaggio d'errore personalizzabile. Vediamo come.
Nostra cartella app/ creaiamo un file app_error.php
[php]
&lt;?php
class AppError extends ErrorHandler {	
	public function accessDenied(){
		$name = array('name' =&gt; __('Your are a really bad guy...stay away from my app!', TRUE));
		$this-&gt;controller-&gt;set($name);
		$this-&gt;_outputMessage('goaway');
	}	
}
?&gt;
[/php]
Poi, nella cartella app/views/errors creaiamo il nostro template goaway.ctp
[php]
&lt;h2&gt;&lt;?php echo $name ?&gt;&lt;/h2&gt;
[/php]

Abbiamo quindi predisposto la nostra applicazione ad essere accessibile solo su https:// e ad inviare le cattive richieste alla tal pagina. Per escludere un campo dal controllo del form da parte del Security component, dovremo disabilitarlo. Nell'esempio qui sotto, disabilito il confirm pwd in users_controller.php
[php]
function beforeFilter() {
	parent::beforeFilter();
		$this-&gt;Security-&gt;blackHoleCallback = 'invalid';
		$this-&gt;Security-&gt;disabledFields = array('User.confirmpassword');
}
[/php]


Ultima cosa, per utilizzare ssl, dovete modificare la configurazione del vostro server. Nel caso utilizziate apache2+linux, &lt;a href=&quot;http://www.howtoforge.com/how-to-set-up-an-ssl-vhost-under-apache2-on-ubuntu-9.10-debian-lenny&quot;&gt;questa&lt;/a&gt; è la guida giusta.
Se volete che il vostro sito sia raggiungibile sia da http che da https(come nel mio caso), ricordatevi che dovete avere due file nella vostra cartella sites-available, uno &quot;miosito&quot; e uno &quot;miosito-ssl&quot;, quest'ultimo con &quot;SSLEngine on&quot;, come ben descritto nella guida linkata. 
</content>
 </entry>
 
 <entry>
   <title>CakePHP e ACL</title>
   <link href="http://username.github.com/2010/11/17/cakephp-e-acl"/>
   <updated>2010-11-17T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/11/17/cakephp-e-acl</id>
   <content type="html">Segnalo qualche link a soluzioni che possono semplificare l'implementazione di ACL in cakePHP
&lt;a href=&quot;http://sourceforge.net/projects/bancer/&quot;&gt;http://sourceforge.net/projects/bancer/&lt;/a&gt;

&lt;a href=&quot;https://github.com/Theaxiom/SuperAuth&quot;&gt;https://github.com/Theaxiom/SuperAuth&lt;/a&gt;

&lt;a href=&quot;https://github.com/markstory/acl_extras&quot;&gt;https://github.com/markstory/acl_extras&lt;/a&gt;

&lt;a href=&quot;https://github.com/markstory/cakephp_menu_component&quot;&gt;https://github.com/markstory/cakephp_menu_component&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>script per rimuovere commenti da files php ricorsivamente</title>
   <link href="http://username.github.com/2010/11/16/script-per-rimuovere-commenti-da-files-php-ricorsivamente"/>
   <updated>2010-11-16T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/11/16/script-per-rimuovere-commenti-da-files-php-ricorsivamente</id>
   <content type="html">Capita che un cliente vi commisioni un progetto, ve ne faccia fare 3/4 e poi decida di non pagarvi l'ultima parte dello sviluppo, quando ormai il grosso e' fatto e le cose da refinire sono poche.
Dovete comunque consegnare il codice ma volete per lo meno togliere i commenti.
Allora piazzate questi due script nella direcotry dove risiedono i file che volete &quot;spurgare&quot;:
rm-phpcomments.sh e strip_comments.php.
rm-phpcomments.sh trova i file php da ripulire e li passa in input a strip_comments.php.
[bash]
#!bin/bash
find . -name &quot;*.php&quot; | while read file
do
	php strip_comments.php $file
done
[/bash]
strip_comments.php li riscrive levando i commenti
[php]
&lt;?php
	$source = $argv[1];
	$fileStr = file_get_contents($source);
	$newStr  = '';

	$commentTokens = array(T_COMMENT);

	if (defined('T_DOC_COMMENT'))
	    $commentTokens[] = T_DOC_COMMENT; 	if (defined('T_ML_COMMENT'))
	    $commentTokens[] = T_ML_COMMENT;  
	$tokens = token_get_all($fileStr);

	foreach ($tokens as $token) {    
	    if (is_array($token)) {
		if (in_array($token[0], $commentTokens))
		    continue;

		$token = $token[1];
	    }

	    $newStr .= $token;
	}

	$handle = fopen($source, &quot;w&quot;);
	if($handle){
		fwrite($handle, $newStr);
		fclose($handle);
		//echo &quot;open&quot;;
	}else{
		echo &quot;no fucking handle!!&quot;;
	}
?&gt;
[/php]
Se il cliente era particolarmente antipatico, se siete troppo affezionati al vostro codice, o  se non avete nessun tipo di spirito solidale verso la persona che dovra' finire il vostro lavoro, potete modificare strip_comments.php inserendo questa simpatica &lt;a href=&quot;http://www.raizlabs.com/software/phpobfuscator/&quot;&gt;libreria&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Installare Bedita</title>
   <link href="http://username.github.com/2010/08/23/installare-bedita"/>
   <updated>2010-08-23T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/08/23/installare-bedita</id>
   <content type="html">Bedita è un CMS basato su CakePHP. O meglio, come lo definiscono i &lt;a href=&quot;http://www.channelweb.it&quot;&gt;suoi sviluppatori&lt;/a&gt;: &lt;em&gt;BEdita is a modular framework that features a back-end Content Management System out-of-the-box.&lt;/em&gt;

Vediamo come installarlo:
Scaricate bedita dal &lt;a href=&quot;http://bedita.com/&quot;&gt;sito ufficiale&lt;/a&gt;  
Create un database e un utente che abbia grant permissions, modificate il file bedita-app/config/database.php e impostate corretamente il vostro user, password e nome del database.
Abilitate sul vostro server la webroot per bedita, supponendo che stiate installando bedita in locale, e che vogliate visualizzare bedita a http://localhost, il vostro file /etc/apache2/sites-available/bedita avra' la variabile DocumentRoot uguale a /path_to_bedita/bedita-app/webroot.
Maggiori informazioni su questo aspetto riguradante la configurazione di apache2 le trovate &lt;a href=&quot;http://guide.debianizzati.org/index.php/LAMP:_Linux,_Apache,_MySQL_e_PHP&quot;&gt;qui&lt;/a&gt;
Create una directory dove bedita caricherà i file, foto, doc ecc...per esempio &quot;media&quot; 
Spostatevi nella cartella &quot;bedita&quot;.
Assicuratevi che il webserver abbia i permessi di scrittura su tale cartella. Supponendo che il server si apache, e che la cartella sia bedita-app/webroot/media
[bash]
chmod -R 777 bedita-app/webroot/media
chown www-data:www-data -R bedita-app/webroot/media
[/bash]
fate la stessa operazione per bedita-app/tmp.
Settate le due variabili mediaRoot e mediaUrl nel file bedita-app/config/bedita.sys.php
[php]
$config['mediaRoot'] = &quot;path_to_bedita_&quot;.DS.&quot;bedita-app&quot;.DS.&quot;webroot&quot;.DS.&quot;media&quot;;
$config['mediaUrl'] = &quot;http://localhost/media&quot;;
[/php]
ovviamente, sostituite a &quot;path_to_bedita&quot; il percorso assoluto dove avete installato bedita nel mio caso 
[php]
$config['mediaRoot'] = &quot;/home/da/public_html/bedita&quot;.DS.&quot;bedita-app&quot;.DS.&quot;webroot&quot;.DS.&quot;media&quot;;
[/php]

nella cartella bedita lanciate lo script che provvederà' a creare le tabelle necessarie.
[bash]
./cake.sh bedita init
[/bash]
Se tutto è andato a buon fine, a questo indirizzo &lt;a href=&quot;http://localhost&quot;&gt;http://localhost&lt;/a&gt; dovreste vedere il pannello d'amministrazione dal quale loggarvi.
user : bedita
pwd : bedita.
fatto.

Perchè dovrei usare bedita quando mi trovo già bene con cakePHP?
Perchè tutto il backend è già fatto, tutto è già predisposto per la vostra galleria immagini, per poter tradurre il sito in altre lingue, per gestire una rubrica degli indirizzi, per inviare una newsletter, per gestire gli utenti. Tutto lavoro già fatto, e fatto bene. 
Inoltre, la procedura d'installazione è molto facile, e l'interfaccia del pannello di amministrazione è molto elegante e intuitiva. Insomma, da provare.

&lt;strong&gt;ah..&lt;/strong&gt;
All'interno della cartella bedita/frontends ci sono degli esempi di come è possibile integrare il potente backend di bedita nel frontend della nostra applicazione. Per provare al volo il frontend stile wordpress aggiungete nella vostra cartella /etc/apache2/sites-available il file bedita-wp. Come webroot impostate il path /path_to_bedita/frontends/wp.example.com/webroot. Ricordatevi di settare i permessi alla cartella tmp in modo che sia accessibile in scrittura al server.
</content>
 </entry>
 
 <entry>
   <title>CakePHP Salvare la data del login ad ogni autenticazione.</title>
   <link href="http://username.github.com/2010/08/23/cakephp-salvare-la-data-del-login-ad-ogni-autenticazione"/>
   <updated>2010-08-23T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/08/23/cakephp-salvare-la-data-del-login-ad-ogni-autenticazione</id>
   <content type="html">Se volete salvare la data del login dei vostri utenti, dovet disabilitare l'autoRedirect nel vostro app_controller. Senza questo piccolo accorgimento, il codice all'interno della funzione login() viene ignorato.
[php]
    function beforeFilter() {
        ....
	$this-&gt;Auth-&gt;autoRedirect = false;
        ....
    }
[/php]

[php]
	function login() {
	    if($this-&gt;Auth-&gt;user()){
		$this-&gt;loginDate();
                //reindirizzamento dopo un corretto login
		$this-&gt;redirect(array('controller' =&gt; 'users', 'action' =&gt; 'view'));
	    }
	}

	function loginDate() {
	    $this-&gt;User-&gt;id = $this-&gt;Session-&gt;read('Auth.User.id');
	    $now = date(&quot;Y-m-d H:i:s&quot;);
	    $this-&gt;User-&gt;saveField('last_login', $now);
	}
[/php] 
</content>
 </entry>
 
 <entry>
   <title>Ruby on Rails, creazione pagine statiche</title>
   <link href="http://username.github.com/2010/08/08/ruby-on-rails-creazione-pagine-statiche"/>
   <updated>2010-08-08T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/08/08/ruby-on-rails-creazione-pagine-statiche</id>
   <content type="html">Supponiamo di avere delle pagine che non richiedono interazioni con il databasa, per esempio 'info', 'terms' e 'contact'.
creiamo le views per le pagine statiche così:
[shell]
cd app/views
mkdir pages
touch pages/info.html.erb
touch pages/terms.html.erb
touch pages/contact.html.erb
[/shell]

Creiamo un controller chiamato pages_controller.rb
[ruby]
class PagesController &lt; ApplicationController
  def show
    page = params[:id]
    render :template =&gt; &quot;pages/#{params[:id]}&quot;
  end
end
[/ruby]

in routes.rb aggiungiamo questa regola
[ruby]
  map.page ':id', :controller =&gt; 'pages',
                  :action =&gt; 'show', 
                  :requirements =&gt; { :id =&gt; /info|terms|contact/ }
[/ruby]

nel nostro layout, aggiungiamo il menu con le voci appena create:
[ruby]
&lt;%= link_to 'Info', page_path('info') %&gt;
&lt;%= link_to 'Terms', page_path('terms') %&gt;
&lt;%= link_to 'Contact', page_path('contact') %&gt;
[/ruby] 
</content>
 </entry>
 
 <entry>
   <title>Ruby On Rails Tutorial, autenticazione con clearance</title>
   <link href="http://username.github.com/2010/08/07/ruby-on-rails-tutorial-autenticazione-con-clearance"/>
   <updated>2010-08-07T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/08/07/ruby-on-rails-tutorial-autenticazione-con-clearance</id>
   <content type="html">&lt;a href=&quot;http://github.com/thoughtbot/clearance&quot;&gt;Clearance&lt;/a&gt; è una gem per Ruby On Rails che permette di integrare velocemente un sistema di autenticazione e registrazione degli utenti. Per installarla nella vostra app:
da root
[bash]
# gem install clearance
[/bash]
poi da utente normale, modificate il file environment.rb e aggiungete la linea &quot;config.gem &quot;clearance&quot;, :version =&gt; &quot;0.8.8&quot;&quot;.
Spostatevi nella directory della vostra app.
[bash]
rake gems:install
rake gems:unpack
[/bash] 
Ora, nella vostra cartella vendor/gems dovrebbe esserci clearance. Installare le gemme in vendor
quindi generate i controller, le view e i model necessari:
[bash]
script/generate clearance
[/bash]

per aggiungere la richiesta d'autenticazione nel vostro controller, semplicemente aggiungete questo codice nel vostro metodo before_filter
[ruby]
 before_filter :authenticate
[/ruby]
Per poter includere i link al login/logout nella vostra applicazione, aggiungete nella view
[ruby]
  &lt;div id=&quot;navigation&quot;&gt;
    &lt;% if signed_in? %&gt;
      &lt;%= link_to 'Sign out', sign_out_path %&gt;
    &lt;% else %&gt;
      &lt;%= link_to 'Sign up', sign_up_path %&gt;
      &lt;%= link_to 'Sign in', sign_in_path %&gt;
    &lt;% end %&gt;
  &lt;/div&gt;
[/ruby]
Se tutto ha funzionato, a questo indirizzo dovreste vedere il form di login http://localhost:3000/sign_in.
Per una lista completa delle url raggiungibili:
[bash]
rake routes
[/bash]
Segnalo la &lt;a href=&quot;http://groups.google.com/group/thoughtbot-clearance&quot;&gt;ML&lt;/a&gt; del progetto e il &lt;a href=&quot;http://wiki.github.com/thoughtbot/clearance/&quot;&gt;wiki&lt;/a&gt; su github, utili nel caso dovreste avere difficoltà durante la configurazione.
</content>
 </entry>
 
 <entry>
   <title>come integrare twitter@anywhere nell'autenticazione di cakePHP</title>
   <link href="http://username.github.com/2010/07/31/come-integrare-twitteranywhere-nellautenticazione-di-cakephp"/>
   <updated>2010-07-31T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/07/31/come-integrare-twitteranywhere-nellautenticazione-di-cakephp</id>
   <content type="html">Twitter @anywhere è l'API di twitter che vi permette di integrare la funzionalità di twitter nel vostro sito con poco codice javascript.
Registrare la vostra application, richiedere le API e cominciare ad usarle sul vostro sito è una cosa che si fa &lt;a href=&quot;http://dev.twitter.com/anywhere&quot;&gt;velocemente&lt;/a&gt; e che non spiego qui.
La cosa che mi interessa è l'integrazione di twitter anywhere nella mia application...ovvero:
Come faccio a far si che se un utente si logga su twitter viene registrato nel mio database ed automaticamente loggato?

Dovrò gestire l'output di twitter anywhere e tramite ajax passarlo ad un handler nel nostro controller che loggherà l'utente in caso sia andato tutto bene, restituirà un errore in caso contrario.

Per prima cosa includiamo questi 2 file js nell'header del nostro template.
[php]
echo $html-&gt;script(&quot;jquery.js&quot;);
echo $html-&gt;script(&quot;checkTwitterUsername.js&quot;);
[/php]

Jquery,js lo trovate sul sito di jquery, lo script checkTwitterUsername.js è una funzione che prende l'output di twitter@anywhere e lo passa all'handler ajax che si occuperà di loggare l'utente.

[javascript]
/*place a &lt;div id = &quot;reply&quot;&gt;&lt;/div&gt; if you want to check te response */
function checkTwitterUsername (twitterusername) {
   if (twitterusername == undefined) {
       alert('twitterusername not setted');
   }else{
        $.ajax({
            type : &quot;POST&quot;,
            url : &quot;/users/handleTwitterUser&quot;,
            data : {name : twitterusername},
            success : function (response) {
                $(&quot;#reply&quot;).append(response);
                window.location.reload();
            },
            error : function (response) {
                $(&quot;#reply&quot;).append(response);
            }
        });
    }
}
[/javascript]
includiamo anche l'element twitter_login.ctp, che fa uso di twitter @anywhere, che trovate qui sotto
[php]
&lt;? echo $this-&gt;element(&quot;twitter_login&quot;)?&gt;
[/php]

twitter_login.ctp
[php]
&lt;?php
$id = 'twitter-login-button-'.rand(1000,9999);
echo '&lt;span id=&quot;'.$id.'&quot;&gt;&lt;/span&gt;';
echo $html-&gt;scriptBlock(&quot;
    twttr.anywhere(function (T) {
        var currentUser,
            screenName,
            profileImage,
            profileImageTag;

        if (T.isConnected()) {
            currentUser = T.currentUser;
            screenName = currentUser.data('screen_name');
            profileImage = currentUser.data('profile_image_url');
            profileImageTag = \&quot;&lt;img src='\&quot; + profileImage + \&quot;'/&gt;\&quot;;
            $('#{$id}').append(\&quot;Logged in as \&quot; + profileImageTag + \&quot; \&quot; + screenName );
            $('#signout').bind(\&quot;click\&quot;, function () {
                twttr.anywhere.signOut();
                window.location.reload();
            });

        } else {
            T('#{$id}').connectButton();
            T.bind(\&quot;authComplete\&quot;, function () {
                if (T.isConnected()) {
                    currentUser = T.currentUser;
                    screenName = currentUser.data('screen_name');
                    checkTwitterUsername(screenName);
                }
            });

        };

    });

    &quot;);
?&gt;

[/php]

Nella vostra tabelle Users aggiungete un campo twitter_username, nel controller users aggiungete questo metodo
[php]
/**
 * It's called by checkTwitterUsername.js
 * Once a user is logged in twitter:
 * 1)if it's not logged in your application and there is no twitter_username as the twitter user logged,
 * create and log the user in your application.
 * If a user with the same twittername exists, log the user.
 * 2)If the user is logged, check if he has a twitter_username, if not, update the value &quot;twitter username&quot;
 *
 * @return string
 * @access public
 **/
function handleTwitterUser(){
	$this-&gt;autoRender = false;
	$msg = &quot;&quot;;
	if(!empty($_POST['name'])){
		$name = $_POST['name'];
		if(!$this-&gt;Auth-&gt;user()){
			$user = $this-&gt;User-&gt;findByTwitterUsername($name);
			if(!$user){
				//generate passowrd
				srand ((double) microtime( )*1000000);
				$random_number = rand(0,10);
				$user['username'] = $name;
				$user['twitter_username'] = $name;
				$user['password'] = $this-&gt;Auth-&gt;password($random_number);
				$user['is_active'] = 1;
				$user['is_verified'] = 1;
				$this-&gt;User-&gt;create();
				$this-&gt;User-&gt;save($user);
				$msg = &quot;User saved and &quot;;
			}
			$this-&gt;Auth-&gt;login($user);
			if($this-&gt;Session-&gt;check('Auth.User')) {
				App::import('Model', 'User');
				$User = new User;
				$User-&gt;store($this-&gt;Session-&gt;read('Auth'));
				$User-&gt;store(array('User' =&gt; array('is_loggedin' =&gt; true)));

			}
			$msg.= &quot;User logged&quot;;
			return $msg;
		}else{
			$user = $this-&gt;User-&gt;findByTwitterUsername($name);
			if(!$user){
				$this-&gt;User-&gt;id = User::get('User.id');
				$this-&gt;data['User']['twitter_username']=$name;
				$this-&gt;User-&gt;store(array('User' =&gt; array('twitter_username' =&gt; $name)));
				$this-&gt;User-&gt;save($this-&gt;data);
				$msg = &quot;your twitter username is now associated with yours profile&quot;;
				return $msg;
			}
		}
	}else{
		$error = &quot;Error, we could not associate your twitter username with your profile&quot;;
		return $error;
	}
}
[/php]
In questa porzione di codice faccio uso di &quot;$User = new User;&quot; per salvare e recuperare in ogni parte della mia applicazione informazioni relative all'utente. Questa tecnica è spiegata bene, con esempi pratici nel libro gratis scaricabile online http://www.pseudocoder.com/free-cakephp-book/

Per poter sloggare l'utente automaticaente sia da twitter che dalla vostra applicazione, dovete far si che il link a logout abbia l'id &quot;signout&quot;.
[php]
echo $this-&gt;Html-&gt;link('logout', array('controller' =&gt; 'users', 'action' =&gt; 'logout' ),
                            array('id'=&gt;'signout')
                );
[/php]

</content>
 </entry>
 
 <entry>
   <title>cakePHP facebook plugin</title>
   <link href="http://username.github.com/2010/07/29/cakephp-facebook-plugin"/>
   <updated>2010-07-29T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/07/29/cakephp-facebook-plugin</id>
   <content type="html">&lt;strong&gt;OUTDATED, questo post si riferisce al vecchio plugin che utilizzava le api OLD rest di facebook. A breve come utilizzare il nuovo plugin.&lt;/strong&gt;

Ho scaricato questo &lt;a href=&quot;http://facebook.webtechnick.com/ &quot;&gt;http://facebook.webtechnick.com/ &lt;/a&gt;plugin per integrare facebook in cakePHP.
Le cose belle di questo plugin sono tre:
1)Permette di integrare il login in facebook con la nostra applicazione
2)Ha un helper &lt;a href=&quot;http://facebook.webtechnick.com/share&quot;&gt;a prova di idiota&lt;/a&gt; per inserire i pulsanti di facebook come &quot;i like it&quot; o &quot;share&quot;.
3)E' facile attingere dalle api per aggiungere nuove funzionalita' al component &quot;Connect.php&quot;

Su quest'ultimo punto, un piccolo esempio. Se avete la necessità di far si che un utente possa pubblicare un link sul wall in facebook dal vostro sito, potete aggiungere al component Connect.php questa semplice funzione, ed utilizzarla direttamente nel vostro controller:
[php]
    function postLinkOnWall($url, $message, $uid){
            $this-&gt;FacebookApi-&gt;api_client-&gt;links_post($url, $message, $uid);
    }
[/php]

Secondo la nuova policy di facebook che entra in vigore il 30 luglio 2010, la vostra applicazione dovrà richiedere all'utente quali &lt;a href=&quot;http://developers.facebook.com/docs/authentication/permissions&quot;&gt;Extended Permissions&lt;/a&gt; concedervi. Nel caso del link sul wall, il permesso che ci interessa è il &quot;publish_stream&quot;. Nell'helper c'è l'apposito metodo &quot;promptPermission&quot; che si occupa di questo, ma se volete personalizzare il messaggio, potete inserire il seguente codice fbml:
[html]
&lt;fb:prompt-permission perms=&quot;publish_stream&quot;&gt;
    Would you like to allow my application to share in facebook this comments?
&lt;/fb:prompt-permission&gt;
[/html]

Per verificare se l'utente ha i permessi richiesti, possiamo aggiungere una funzione al component, e richiamarla quando ne abbiamo bisogno:
[php]
    function hasPublishPermitted($ext_perm, $uid){
        return $this-&gt;FacebookApi-&gt;api_client-&gt;users_hasAppPermission($ext_perm, $uid);
    }
[/php]

Se ci sono altre funzioni alle quali volete accedere dal component &quot;Connect&quot;, vi consiglio di leggervi il file /vendors/facebook/php/facebookapi_php5_restlib.php
</content>
 </entry>
 
 <entry>
   <title>cakePHP paypal component</title>
   <link href="http://username.github.com/2010/07/23/cakephp-paypal-component"/>
   <updated>2010-07-23T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/07/23/cakephp-paypal-component</id>
   <content type="html">Ho realizzato un component per il methodo &quot;parallel payment&quot; previsto dalle API di Paypal. Questo metodo permette di pagare piu' utenti con un solo checkout. Utile nel caso aveste un negozio online dove piu' persone devono ricevere il pagamento.
Tutto sul mio repo &lt;a href=&quot;http://github.com/edap/cakePHP_paypal_component&quot;&gt;http://github.com/edap/cakePHP_paypal_component&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>cakePHP todolist plugin</title>
   <link href="http://username.github.com/2010/05/24/cakephp-todolist-plugin"/>
   <updated>2010-05-24T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/05/24/cakephp-todolist-plugin</id>
   <content type="html">Ho realizzato un plugin per cakePHP che permette di creare una ToDo list, aggiungere dei compiti e assegnarli a diversi users.
&lt;a href=&quot;http://github.com/edap/todolist&quot;&gt;http://github.com/edap/todolist&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>Fatal error: Call to a member function setFlash() on a non-object</title>
   <link href="http://username.github.com/2010/05/14/fatal-error-call-to-a-member-function-setflash-on-a-non-object"/>
   <updated>2010-05-14T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/05/14/fatal-error-call-to-a-member-function-setflash-on-a-non-object</id>
   <content type="html">Ovvero, cose basilari per la migrazione da cake 1.2 a cake 1.3
Partiamo con l'errore che leggete nel titolo. Il component Session non è più incluso di default. Va quindi aggiunto nell'app_controller.php
[php]
class AppController extends Controller{
var $components = array('Auth','Session);
[/php]
Routing.admin è deprecato.
[php]
//da:
Configure::write('Routing.admin', 'admin');

//a:
Configure::write('Routing.prefixes', array('admin'));

[/php]
&lt;ul&gt;
	&lt;li&gt;Il metodo del() nei controller è sostituito con delete()&lt;/li&gt;
	&lt;li&gt;cake/tua_app_cake_1.2/webroot/index.php è da sostituire con index.php di cake 1.3&lt;/li&gt;
	&lt;li&gt;Il metodo renderElement non è più supportato, al suo posto usare Element&lt;/li&gt;
	&lt;li&gt;$javascript-&amp;gt;link() va sostituito con $html-&amp;gt;script()&lt;/li&gt;
	&lt;li&gt;$javascript-&amp;gt;codeBlock() va sostituito con $html-&amp;gt;scriptBlock()&lt;/li&gt;
	&lt;li&gt;In route.php, sostituire route.admin&lt;/li&gt;
&lt;/ul&gt;
Se avete installato dei plugin esterni, se avete scritto dei component personalizzati, controllate la &lt;a href=&quot;http://book.cakephp.org/view/1561/Migrating-from-CakePHP-1-2-to-1-3&quot;&gt;guida ufficiale&lt;/a&gt;, le novità sono parecchie.
</content>
 </entry>
 
 <entry>
   <title>upload immagini con resize automatico in CakePHP</title>
   <link href="http://username.github.com/2010/04/22/upload-immagini-con-resize-automatico-in-cakephp"/>
   <updated>2010-04-22T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/04/22/upload-immagini-con-resize-automatico-in-cakephp</id>
   <content type="html">Capita spesso di dover inserire un form per l'upload delle immagini nella sezione amministrativa del nostro sito. 
C'è un &lt;a href=&quot;http://github.com/tute/Thumbnail-component-for-CakePHP/&quot;&gt;component&lt;/a&gt; che fa al caso nostro, scala automaticamente ogni immagine in tre formati, big,med,small e la carica nella cartella predefinita.
I passi per la configurazione sono pochi, presenti sul repo. 
Dopo aver installato correttamente il component, ricordatevi che il path del file va salvato nel database. Modifichiamo quindi il controller per poter salvare il path dell'immagine nel campo 'file_path'
[php]
function admin_add() {
        if (!empty($this-&gt;data)) {
                $this-&gt;Pianta-&gt;create();
                if ($this-&gt;Pianta-&gt;save($this-&gt;data)) {
                        $file_path = $this-&gt;Attachment-&gt;upload($this-&gt;data['Pianta']['Attachment']);
                        if(isset($file_path)){
                            $this-&gt;Pianta-&gt;saveField('file_path',$file_path);
                        }
                        $this-&gt;Session-&gt;setFlash(__('The Pianta has been saved', true));
                        $this-&gt;redirect(array('action' =&gt; 'index'));
                } else {
                        $this-&gt;Session-&gt;setFlash(__('The Pianta could not be saved. Please, try again.', true));
                }
        }
}
[/php]
</content>
 </entry>
 
 <entry>
   <title>Friendly URL con CakePHP</title>
   <link href="http://username.github.com/2010/04/11/friendly-url-con-cakephp"/>
   <updated>2010-04-11T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/04/11/friendly-url-con-cakephp</id>
   <content type="html">Per una corretta indicizzazione del nostro sito sui motori di ricerca, le URL dovrebbero contenere delle parole chiave coerenti con i contenuti.
Ecco quindi che una pagina dalla url:
&lt;strong&gt;www.miosito.com/view/24&lt;/strong&gt;
dovrebbe diventare
&lt;strong&gt;www.miosito.com/view/come-ottenere-friendly-url
&lt;/strong&gt;per essere più appetibile al motore di ricerca.

Per ottenere delle Friendly URL in cakePHP basta scaricare dal&lt;a href=&quot;http://github.com/mariano/syrup/blob/master/models/behaviors/sluggable.php&quot;&gt; repo su github di Mariano Iglesias&lt;/a&gt; &quot;sluggable behavior&quot; e metterlo in app/model/behavior/sluggable.php.

Aggiungrere questa linea nel model 'articolo', che dice a cake di usare il behaviors prima scaricato:
[php]
var $actsAs = array('Sluggable'); 
[/php]
Ora l'articolo può essere richiamato da un nome significativo e non dall'id. Aggiungiamo quindi nella tabella 'Articoli' il campo 'slug'. Se volete cambiare il nome di questo campo, o utilizzare il campo title, o vedere altre opzioni, qui le potete trovare &lt;a href=&quot;http://bakery.cakephp.org/articles/view/sluggable-behavior&quot;&gt;http://bakery.cakephp.org/articles/view/sluggable-behavior&lt;/a&gt;
Dovete poi modificare la funzione view del vostro controller, aggiungendo il campo slug.
[php]
function view($slug = null) {
    if(!$slug){
            $this-&gt;Session-&gt;setFlash(__('Invalid Articolo', true));
            $this-&gt;redirect(array('action' =&gt; 'index'));
    }
    $articolo = $this-&gt;Articolo-&gt;findBySlug($slug);
    $this-&gt;set('articolo', $articolo);
}
[/php]

Per richiamare l'articolo, passiamo al metodo view il valore del campo slug anzichè l'id.
[php]
&lt;?php echo $html-&gt;link('Articolo bello', array('controller'=&gt;'Articoli', 'action'=&gt;'view', 'valore del mio campo slug'))  ?&gt;
[/php]
Per far si che ogni volta che aggiungete un nuovo articolo, o che vogliate modificarne uno esistente, venga aggiornato il valore del campo 'slug', dovete settare il valore di a true nel vostro model
[php]
var $actsAs = array('Sluggable' =&gt; array( 'overwrite' =&gt; true)); 
[/php]

Una volta fatto questo, potremmo anche decidere di migliorare ulteriormente l'url, passando da:
&lt;strong&gt;www.miosito.com/view/come-ottenere-friendly-url
&lt;/strong&gt; a
&lt;strong&gt;www.miosito.com/articoli_SEO/come-ottenere-friendly-url
&lt;/strong&gt;

per far questo basta aggiungere un alias nel file routes.php
[php]
Router::connect('/articoli_SEO/*', array('controller' =&gt; 'articoli', 'action' =&gt; 'view'));
[/php]

In CakePHP si possono fare tante cose modificando il file routes.php.
Una buona lettura la trovate &lt;a href=&quot;http://bakery.cakephp.org/articles/view/cakephp-s-routing-explained&quot;&gt;qui&lt;/a&gt; 
</content>
 </entry>
 
 <entry>
   <title>Warning: strtotime(), cakephp 1.2 e php 5.3</title>
   <link href="http://username.github.com/2010/04/03/warning-strtotime-cakephp-1-2-e-php-5-3"/>
   <updated>2010-04-03T00:00:00+02:00</updated>
   <id>hhttp://username.github.com/2010/04/03/warning-strtotime-cakephp-1-2-e-php-5-3</id>
   <content type="html">Potrebbe capitare di ricevere questo warning su di un vostro sito sviluppato con cake.
&lt;code&gt;Warning: strtotime() [function.strtotime]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'Europe/Berlin' for 'CEST/2.0/DST' instead in /home/da/public_html/under/cake/libs/cache.php on line 429&lt;/code&gt;

Per eliminarlo, basta settare correttamente il timezone nel vostro php.ini
Per esempio:
&lt;code&gt;date.timezone = Europe/London&lt;/code&gt;
Un elenco di tutti i timezone disponibili può essere trovato qui:
&lt;a href=&quot;For example: date.timezone = Europe/London http://uk2.php.net/manual/en/timezones.europe.php&quot;&gt;http://uk2.php.net/manual/en/timezones.europe.php&lt;/a&gt;
</content>
 </entry>
 
 <entry>
   <title>conoscere la posizione di un dominio su google per determinate keywords</title>
   <link href="http://username.github.com/2010/03/24/conoscere-la-posizione-di-un-dominio-su-google-per-determinate-keywords"/>
   <updated>2010-03-24T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/03/24/conoscere-la-posizione-di-un-dominio-su-google-per-determinate-keywords</id>
   <content type="html">Si, lo script permette di fare quello che che dice il titolo di questo post.
Ho aggiunto allo script &lt;a href=&quot;http://www.geekology.co.za/blog/2009/02/python-script-to-check-google-rankings-for-domain-and-search-term/&quot;&gt;rankcheck.py&lt;/a&gt; un file di testo che elenca le keywords che vogliamo testare e un file che legge queste keywords e le passa a rankcheck.py.

Scaricarsi i file dal mio repo su &lt;a href=&quot;http://github.com/edap/checkdomain&quot;&gt;github&lt;/a&gt;. Mettere tutto in una cartella nella vostra home directory. Settare i path del file rankcheck.py e keywords_list.txt in checkdomain.py. Nello stesso file, scegliete il dominio che volete testare.
Se volete i risultati su un file da passare al vostro cliente, dalla console:
[shell]python chekdomain.py &amp;gt; risultati.txt[/shell] 
</content>
 </entry>
 
 <entry>
   <title>Implementare velocemente una Newsletter in CakePHP</title>
   <link href="http://username.github.com/2010/03/20/implementare-velocemente-una-newsletter-in-cakephp"/>
   <updated>2010-03-20T00:00:00+01:00</updated>
   <id>hhttp://username.github.com/2010/03/20/implementare-velocemente-una-newsletter-in-cakephp</id>
   <content type="html">Link utili per costruire una newsletter in cakephp.
Utilizziamo un plugin già fatto, scaricarlo da qui
&lt;a href=&quot;http://github.com/innovativepm/cakephp-newsletter-plugin&quot;&gt;http://github.com/innovativepm/cakephp-newsletter-plugin&lt;/a&gt;

aggiungere questo behaviour in app/models/behaviour/
&lt;a href=&quot;http://bakery.cakephp.org/articles/view/add-delete-habtm-behavior&quot;&gt;http://bakery.cakephp.org/articles/view/add-delete-habtm-behavior&lt;/a&gt;

Scaricare swift &lt;a href=&quot;http://swiftmailer.org/download&quot;&gt;http://swiftmailer.org/download&lt;/a&gt; ed installarlo seguendo questo tutorial
&lt;a href=&quot;http://bakery.cakephp.org/articles/view/updated-swiftmailer-4-xx-component-with-attachments-and-plugins&quot;&gt;http://bakery.cakephp.org/articles/view/updated-swiftmailer-4-xx-component-with-attachments-and-plugins&lt;/a&gt;

Assicurarsi che nell'appController ci sia un metodo SendMail, ovviamente con il component swiftMailer incluso.
Nel plugin scaricato, sono presenti dei file di configurazione, modificarli a seconda delle vostre esigenze
&lt;a href=&quot;http://github.com/fabiokr/cakephp-newsletter-plugin&quot;&gt;http://github.com/fabiokr/cakephp-newsletter-plugin&lt;/a&gt;

aggiungere la chiamata a jquery nella cartella del plugin newsletter
in mail/admin_send.ctp
[php]link(&quot;jquery.min.js&quot;); [/php]

modificare i link che nel nostro percorso di navigazione richiamano parti relative al plugin, es &quot;www.miosito.com/newsletter&quot;.
&lt;a href=&quot;http://github.com/fabiokr/cakephp-newsletter-plugin&quot;&gt;http://book.cakephp.org/view/868/Plugin-routing&lt;/a&gt;

Importante!
Il plugin richiede che nel vostro app controller ci sia un metodo sendEmail. Se usate questa funzione per l'invio di mal non legate alla newsletter, potrebbe non servirvi il template della newsletter.
Quindi nel metodo dovete specifcare il vostro template (linea 10).
[php]class AppController extends Controller{
	var $components = array('Auth','SwiftMailer');

	function sendEmail($subject, $viewSend=null, $to=null, $from = null, $fromName = null) {
		$this-&gt;SwiftMailer-&gt;smtpHost = 'localhost';
		//$this-&gt;SwiftMailer-&gt;sendAs = 'html';
		if($to == null) {
			$to = Configure::read('Newsletter.from_email');
		}
		if($viewSend == null) {
			$view = Configure::read('Newsletter.default_view');
			$this-&gt;set('message', 'My message');
		}else{
			$view = 'newsletter';
			$this-&gt;set('message', $viewSend);
		}
		$this-&gt;SwiftMailer-&gt;from         = $from != null ? $from : Configure::read('Newsletter.from_email');
		$this-&gt;SwiftMailer-&gt;fromName     = $fromName != null ? $fromName : Configure::read('Newsletter.from');
		$this-&gt;SwiftMailer-&gt;to           = $to;
		$method           = 'smtp';

		try {
			if(!$this-&gt;SwiftMailer-&gt;send($view, $subject, $method, true)) {
				$this-&gt;log(&quot;Error sending email&quot;);
			}
		}
		catch(Exception $e) {
			$this-&gt;log(&quot;Failed to send email: &quot;.$e-&gt;getMessage());
		}

	}

}[/php] 
</content>
 </entry>
 
 
</feed>